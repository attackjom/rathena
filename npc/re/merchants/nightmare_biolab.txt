//===== rAthena Script =======================================
//= Nightmare Biolab NPCs
//===== Description: =========================================
//= [Walkthrough Conversion]
//= Nightmare Biolab exchange NPCs
//  NOTE: The nightmare biolab monsters are currently missing
//  some items used in the file.
//    Silent Energy Particles (ID: 25127)
//    Weak Energy Particles (ID: 25128)
//    Unstable Energy Particles (ID: 25129)
//    Sinister Energy Particles (ID: 25130)
//    Cursed Crystal (ID: 23080)
//===== Changelogs: ==========================================
//= 1.0 First version. [Capuche]
//= 1.1 Added some missing warp points and lore pieces [akaineko]
//============================================================

// Item Functions
//============================================================
function	script	F_Pieces_Of_Sentiment	{	// 22687
	if (strcharinfo(3) == "lhz_dun_n")// usage forbidden on the same map
		return;
	specialeffect2 EF_HIT4;
	.@r = rand(18);
	if (.@r == 0)
		warp "lhz_dun_n",40,212;
	else if (.@r == 1)
		warp "lhz_dun_n",87,84;
	else if (.@r == 2)
		warp "lhz_dun_n",140,89;
	else if (.@r == 3)
		warp "lhz_dun_n",162,252;
	else if (.@r == 4)
		warp "lhz_dun_n",201,101;
	else if (.@r == 5)
		warp "lhz_dun_n",34,70;
	else if (.@r == 6)
		warp "lhz_dun_n",75,138;
	else if (.@r == 7)
		warp "lhz_dun_n",78,189;
	else if (.@r == 8)
		warp "lhz_dun_n",28,140;
	else if (.@r == 9)
		warp "lhz_dun_n",240,64;
	else if (.@r == 10)
		warp "lhz_dun_n",140,39;
	else if (.@r == 11)
		warp "lhz_dun_n",140,191;
	else if (.@r == 12)
		warp "lhz_dun_n",124,138;
	else if (.@r == 13)
		warp "lhz_dun_n",131,235;
	else if (.@r == 14)
		warp "lhz_dun_n",140,114;
	else if (.@r == 15)
		warp "lhz_dun_n",99,106;
	else if (.@r == 16)
		warp "lhz_dun_n",115,253;
	else
		warp "lhz_dun_n",230,138;
	delitem 22687,1;
	return;
}

function	script	F_Cursed_Crystal	{	// 23080
	// custom rates
	.@r = rand(500);
	if (.@r < 10)		getitem 23016,100;// Cursed_Fragment
	else if (.@r < 352)	getitem 23016,200;// Cursed_Fragment
	else if (.@r < 469)	getitem 23016,300;// Cursed_Fragment
	else if (.@r < 498)	getitem 23016,400;// Cursed_Fragment
	else				getitem 23016,500;// Cursed_Fragment
	return;
}

function	script	F_Cursed_Fragment	{	// 23016
	// custom rates
	.@r = rand(981);
	if (.@r < 166) {
		if (rand(2) == 0)
			showscript "¡ÃØ³Ò...ÍÂÙè¡Ñº¢éÒ...";
		else
			showscript "ÍÂÙè...µÃ§¹Õé¡Ñº¢éÒ...";
		sleep2 200;
		warp "Random",0,0;
	}
	else if (.@r < 231)	{
		showscript "µÃ§¹ÕéÁÑ¹Ë¹ÒÇ¨Ñ§...";
		sc_start SC_FREEZE,8000,0;
	}
	else if (.@r < 304) {
		showscript "¢éÒ¢Íâ·É...¢éÒ¨Ðä»áÅéÇ...¢Íº¤Ø³...";
		getitem 6820,1;// Energy_Fragment
	}
	else if (.@r < 317)
		sc_start SC_CONFUSION,3000,0;
	else if (.@r < 328) {
		showscript "ã¤Ã¡çä´éªèÇÂ¢éÒ·Õ...";
		sc_start SC_CURSE,3000,0;
	}
	else if (.@r < 408) {
		showscript "á´è Odin...";
		sc_start SC_ASSUMPTIO,100000,5;
		specialeffect2 EF_ASSUMPTIO;
	}
	else if (.@r < 496) {
		showscript "¢éÒ¨ÐäÁèÅ×Áà¨éÒ...!";
		sc_start SC_ATKPOTION,600000,10;
		sc_start SC_MATKPOTION,600000,10;
	}
	else {
		.@rand = rand(5);
		if (.@rand == 0)
			showscript "µ×è¹à¶ÍÐ!";
		else if (.@rand == 1)
			showscript "ËÂØ´·Õ...ÁÑ¹à¨çº...";
		else if (.@rand == 2)
			showscript "¢éÒ¡ÅÑÇ...¡ÅÑÇáÅéÇ...";
		else if (.@rand == 3)
			showscript "à¨éÒäÁè¤ÇÃÁÒ·Õè¹Õè...";
		else
			showscript "ËÇÑ´´Õ...ÁÕã¤ÃäËÁ...?";
	}
	return;
}


// Nightmare Biolab Entrances
lighthalzen,321,218,4	script	Ohno Tohiro#1	4_M_RASWORD,{
	disable_items;
	mes "[Ohno Tohiro]";
	.@r = rand(1,10);
	if (.@r < 6)
		mes "¢éÒ¶Ù¡¢ÍãËéÃÇºÃÇÁ research charts...";
	else if (.@r < 7) {
		mes "- ©Ñ¹ä´éÂÔ¹ã¤ÃºÒ§¤¹¾Ù´ - - ¡ÒÃÊ×èÍÊÒÃ·Ò§ä¡Å -";
		next;
		mes "[Ohno Tohiro]";
		mes "ãªè ... ·Ø¡ÍÂèÒ§´Óà¹Ô¹ä»ÍÂèÒ§ÃÒºÃ×è¹";
		mes "Ê¶Ò¹Ð¢Í§¡ÒÃÃÇºÃÇÁÃÒÂ§Ò¹àÃÕÂºÃéÍÂáÅéÇ";
		mes "¤ÃÑº·èÒ¹";
		next;
		mes "[Ohno Tohiro]";
		mes "©Ñ¹¨ÐÃÒÂ§Ò¹¢éÍÁÙÅ·Õèà¡ÕèÂÇ¢éÍ§¡ÑºËéÍ§»¯ÔºÑµÔ¡ÒÃà»ç¹ÅÓ´Ñº¤ÇÒÁÊÓ¤Ñ­ÊÙ§ÊØ´·Ñ¹·Õ";
		mes "¤ÃÑº·èÒ¹ ... ¼Á¨Ð·Ó";
		next;
		mes "[Ohno Tohiro]";
		mes "ÁÕã¤ÃÁÒºéÒ§à´ÕëÂÇâ·ÃËÒÍÕ¡·Õ";
	}
	else {
		mes "[Ohno Tohiro]";
		mes "äËÅè¢Í§©Ñ¹Ë¹Ñ¡";
		mes "¤ÇÒÁ»ÃÒÃ¶¹ÒÍÑ¹ÂÒÇ¹Ò¹¢Í§àÃÒ .. ";
		mes "·ÕÅÐ¤¹ªéÒæ .. ";
	}
	next;
	mes "[Ohno Tohiro]";
	mes "Ë×Í...? ¢éÒäÁèÃÙéÇèÒÁÕã¤ÃÍÂÙè·Õè¹ÕèºéÒ§...";
	mes "Ë×Á...Ë×Á...";
	mes "ÁÕºÒ§ÍÂèÒ§·Õèà¨éÒµéÍ§¡ÒÃ¨Ò¡¢éÒäËÁ ?";
	while(true) {
		next;
		switch( select( "¨º¡ÒÃÊ¹·¹Ò.", "¶ÒÁà¡ÕèÂÇ¡Ñº tomb of honor.", "¡ÅÑºä»·Õèè tomb of honor.", "ºÍ¡ÇèÒÁÕà§Ô¹äÁè¾Í." ) ) {
		case 1:
			mes "[Ohno Tohiro]";
			mes "ÁÕ¹Ñ¡¼¨­ÀÑÂ¨Ó¹Ç¹ÁÒ¡·Õè¡ÓÅÑ§ÁÍ§ËÒÃÍÂáÂ¡¹Õé, Â¡àÇé¹à¨éÒ!";
			mes "¶éÒà¨éÒà»ÅÕèÂ¹ã¨, ãËé¡ÅÑºÁÒËÒ¢éÒ!";
			close;
		case 2:
			mes "[Ohno Tohiro]";
			mes "à¨éÒà¤Âä´éÂÔ¹à¡ÕèÂÇ¡ÑºÃÍÂáÂ¡·Õè¹Óä»ÊÙèÊ¶Ò¹·Õè¹Ñè¹, ¶Ù¡äËÁ ?";
			mes "¹Ñ¡¼¨­ÀÑÂÊèÇ¹ÁÒ¡¡çàËÁ×Í¹à¨éÒÇÑ¹¹Õé!";
			next;
			mes "[Ohno Tohiro]";
			mes "¢éÒà¢éÒä»ã¹ÃÍÂáÂ¡¤ÃÑé§áÃ¡áÅÐà´ÒÇèÒ ? ÁÑ¹¨Ð¹Óä»ÊÙèÊ¶Ò¹·Õè·ÕèÁÕÁÍ¹ÊàµÍÃì¨Ó¹Ç¹ÁÒ¡.";
			next;
			mes "[Ohno Tohiro]";
			mes "¢éÒÂ¡ÁÑ¹ãËé¡Ñº¹Ñ¡¼¨­ÀÑÂ¤¹Ë¹Öè§ ·Õè¢éÒÃÙé¨Ñ¡. ËÅÑ§¨Ò¡¹Ñé¹, à¢Ò¡çáÊ´§¤ÇÒÁÊ¹ã¨ÍÂèÒ§ÁÒ¡ã¹àÃ×èÍ§¹Õé!";
			mes "à¢Ò¾ÖÁ¾Ó¡ÑºµÑÇàÍ§à¡ÕèèÂÇ¡Ñº biomedical research, àËÁ×Í¹¨ÐÁÕËéÍ§·´ÅÍ§ºÒ§ÍÂèÒ§.";
			next;
			mes "[Ohno Tohiro]";
			mes "à¢Ò¢ÍÃéÍ§ãËé¢éÒáÊ´§ãËéà¢Ò´ÙÇèÒä»·Õè¹Ñè¹ä´éÍÂèÒ§äÃ. ¢éÒÅÑ§àÅ·Õè¨ÐãËéà¢ÒÃÙéàÃ×èÍ§à¡ÕèÂÇ¡ÑºÃÍÂáÂ¡à¾ÃÒÐ¢éÒäÁèµéÍ§¡ÒÃãËéã¤ÃÃÙéàÃ×èÍ§¹Õé. áµè¢éÒ¢ÒÂ¢éÍÁÙÅ¹Õé´éÇÂà§Ô¹ 100,000 Zeny.";
			next;
			mes "[Ohno Tohiro]";
			mes "äÁè¹Ò¹¹Ñ¡, à¢Ò¡ÅÑºÁÒ¾ÃéÍÁ¡ÑºÃèÒ§¡ÒÂ·ÕèÊÒËÑÊ. ÁÑ¹¤§à»ç¹»Ò¯ÔËÒÃÔÂì·Õèà¢ÒÃÍ´¡ÅÑºÁÒä´é...¹èÒ¡ÅÑÇÁÒ¡...";
			mes "ÍÂèÒ§äÃ¡çµÒÁ, à¢Òä´é¢Í§ÁÒËÅÒÂÍÂèÒ§. àËç¹¤ÃÑé§áÃ¡, ÁÑ¹´Ù·Ã§¾ÅÑ§ÁÒ¡¹Ñé¹·ÓãËé¢éÒ¡ÅÑÇ.";
			next;
			mes "[Ohno Tohiro]";
			mes "ã¹àÇÅÒµèÍÁÒ, ¹Ñ¡¼¨­ÀÑÂ¨Ó¹Ç¹ÁÒ¡à¢éÒÁÒã¹Ê¶Ò¹·ÕèæÍÑ¹µÃÒÂ¼èÒ¹ÃÍÂáÂ¡¹ÕéËÅÑ§¨Ò¡ä´éÂÔ¹¢èÒÇÅ×Í. ¢éÒäÁèà¤Â¾º¡Ñº¾Ç¡à¢ÒÍÕ¡àÅÂ. µÑé§áµè¹Ñé¹à»ç¹µé¹ÁÒ, Ê¶Ò¹·Õè¹Õé¶Ù¡àÃÕÂ¡ÇèÒ tomb of honor.";
			mes "áÁéÇèÒ, ¢éÒ¨Ðä´éÃÑºà§Ô¹¢Íº¤Ø³ºÒ§ÊèÇ¹¨Ò¡¾Ç¡à¢Ò.";
			next;
			mes "[Ohno Tohiro]";
			mes "à¨éÒµéÍ§¡ÒÃ·ÃÒºÊÒàËµØ·Õè¢éÒÃÑºà§Ô¹ ?";
			mes "¢éÒà¨ÍÊ¶Ò¹·Õè¹Õéà»ç¹¤¹áÃ¡, ´Ñ§¹Ñé¹¤ÇÒÁà»ç¹à¨éÒ¢Í§¨Ö§µ¡à»ç¹¢Í§¢éÒ! à¨éÒÁÕ»Ñ­ËÒäËÁ ?";
			next;
			mes "[Ohno Tohiro]";
			mes "Ë×Á Ë×Á...ÍÂèÒ§äÃ¡çµÒÁ, ãËéà§Ô¹¢éÒ 100,000 Zeny. áÅéÇ, ¢éÒ¨Ðà»Ô´»ÃÐµÙ·Õè¨Ð¹Óä»ÊÙèÃÍÂáµ¡ÊÓËÃÑº¹Ñ¡¼¨­ÀÑÂÍÂèÒ§à¨éÒ...";
			continue;
		case 3:
			if (Zeny < 100000) {
				mes "[Ohno Tohiro]";
				mes "à¨éÒÁÕà§Ô¹äÁè¾Í!";
				mes "ã¹âÅ¡¹ÕéäÁèÁÕ¢Í§¿ÃÕËÃÍ¡¹Ð!";
				continue;
			}
			mes "[Ohno Tohiro]";
			mes "äË¹´ÙÊÔ...Ë¹Öè§...ÊÍ§...ÊÒÁ";
			mes "¢éÒä´éÃÑºà§Ô¹ÁÒ¤ÃºáÅéÇ, ¢éÒ¨Ðà»Ô´ãËéà´ÕëÂÇ¹Õé.";
			mes "¢éÒËÇÑ§ÇèÒà¨éÒ¨ÐÃÍ´¡ÅÑºÁÒ!...";
			next;
			if (Zeny >= 100000) {
				Zeny -= 100000;
				warp "lhz_dun_n",100,202;
			}
			end;
		case 4:
			mes "[Ohno Tohiro]";
			mes "ÍÐäÃ ? à¨éÒäÁèÁÕà§Ô¹, áµèà¨éÒµéÍ§¡ÒÃ¨Ðà¢éÒä» ?";
			mes "Ë×Á...§Ñé¹...µéÍ§ÁÕ¢Í§ÁÒáÅ¡, à¨éÒÁÕ research chart ºéÒ§äËÁ ?";
			next;
			mes "[Ohno Tohiro]";
			mes "¨Øêæ, ¾Ù´àºÒæ. à´ÕëÂÇ¤¹á¶Ç¹Õéä´éÂÔ¹. áÅéÇà¨éÒÁÕËÃ×ÍäÁèÁÕ ?";
			next;
			mes "[Ohno Tohiro]";
			mes "ÍÂèÒÁÒ¶ÒÁÇèÒ¢éÒàÍÒä»·ÓÍÐäÃ. á¤è¹Ó 10 research charts ÁÒãËé¢éÒ¡ç¾Í. áÅéÇ, ¢éÒ¨ÐÊè§à¨éÒä»·Õè tomb of honor àÍ§. à¨éÒ¤Ô´ÇèÒä§ ?";
			next;
			if (select( "¡ÅÑºä»·ÕèàÁ¹Ù¡èÍ¹Ë¹éÒ.", "ãËé 10 research charts." ) == 1) {
				mes "[Ohno Tohiro]";
				mes "à¨éÒäÁèÍÂÒ¡·Ó¸ØÃ¡Ô¨¡Ñº¢éÒ ?";
				continue;
			}
			if (countitem(7347) < 10) {
				mes "[Ohno Tohiro]";
				mes "´ÙàËÁ×Í¹ 10 research charts ¨ÐäÁè¤Ãº.";
				mes "ºÒ§·Õà¨éÒÍÒ¨Å×ÁËÂÔºÍÍ¡¨Ò¡¤ÅÑ§.";
				next;
				mes "[Ohno Tohiro]";
				mes "ÁÕÍÐäÃ·Õèà¨éÒµéÍ§¡ÒÃ¨Ò¡¢éÒäËÁ ?";
				continue;
			}
			mes "[Ohno Tohiro]";
			mes "âÍé...ãªè, ¹ÕèáËÅÐ...·Õè¢éÒµéÍ§¡ÒÃ...ËØ ËØ...";
			next;
			mes "[Ohno Tohiro]";
			mes "¢éÒ¨ÐÊè§à¨éÒä»·ÕèÃÍÂáÂ¡µÒÁÊÑ­­Ò.";
			mes "¢éÒÍÂÒ¡ãËéà¨éÒÃÍ´. áÅéÇ¾º¡Ñ¹ãËÁè!";
			next;
			delitem 7347,10;// Lab_Staff_Record
			warp "lhz_dun_n",100,202;
			end;
		}
	}
}

lighthalzen,320,204,3	script	A kid with black finger	4_F_04,{
	disable_items;
	mes "[Lunar]";
	mes "à¨éÒ¡ÓÅÑ§ÁÍ§ËÒÍÐäÃ ? à¨éÒ¡ÓÅÑ§ÁÍ§ËÒÊ¶Ò¹·ÕèæÁÕ¤¹µÒÂà´Ô¹à¾è¹¾èÒ¹ä»·ÑèÇËÃ×Í ?";
	next;
	mes "[Lunar]";
	mes "¢éÒ¾Òà¨éÒä»·Õè¹Ñé¹ä´é¶éÒà¨éÒµéÍ§¡ÒÃ. à¨éÒµéÍ§ÁÕ ^0000cd20 Sentimental Fragment áÅÐ 150K Zeny^000000.";
	next;
	mes "[Lunar]";
	mes "ËÃ×Íà¨éÒÁÍ§ËÒÊ¶Ò¹·Õèæ»ÅÍ´ÀÑÂ»ÃÒÈ¨Ò¡¾Ç¡¤¹µÒÂ. à¨éÒµéÍ§¨èÒÂ´éÇÂ ^0000cd30 Sentimental Fragment áÅÐ 2M Zeny^000000.";
	next;
	mes "[Lunar]";
	mes "à¨éÒµéÍ§¡ÒÃä»·ÕèäË¹ ?";
	next;
	switch( select( "·ÕèæàµçÁä»´éÇÂ¤¹µÒÂ.", "Ê¶Ò¹·ÕèæÊ§º.", "Ê¶Ò¹·ÕèÑé¹Ñè¹¤×ÍÍÐäÃ?", "äÁèà»ç¹äÃ." ) ) {
	case 1:
		mes "[Lunar]";
		mes "ä´éµÒÁ·Õèà¨éÒµéÍ§¡ÒÃ ?";
		next;
		if (countitem(22687) < 20 || Zeny < 150000) {
			mes "[Lunar]";
			mes "´ÙÊÔ.";
			next;
			mes "[Lunar]";
			mes "ÁÑ¹äÁè¾Í. à¨éÒµéÍ§ÁÕ ^0000cd20 Sentimental Fragment áÅÐ 150K Zeny^000000. ¢éÒ¾Òà¨éÒä»¿ÃÕæäÁèä´é.";
			close;
		}
		mes "[Lunar]";
		mes "ä´éµÒÁ·Õèà¨éÒµéÍ§¡ÒÃ ?";
		next;
		mes "[Lunar]";
		mes "´ÕàÅÂ. à¨éÒÁÕ¤Ãº. ¢éÒ¨Ð¾Òà¨éÒä».";
		next;
		mes "[Lunar]";
		mes "áµè...¢éÒ¾Òà¨éÒä»à¾ÃÒÐà§Ô¹...à¨éÒµéÍ§´ÙáÅµÑÇàÍ§.";
		next;
		mes "[Lunar]";
		mes "´Ñ§¹Ñé¹..àÁ×èÍà¨éÒà¢éÒä»áÅéÇ, à¨éÒ¨ÐàËç¹ ^0000cdStrange Machine ·Õè´ÙàËÁ×Í¹ crystal^000000.";
		next;
		mes "[Lunar]";
		mes "à¨éÒà¤Ã×èÍ§¹Õé¨Ð¿×é¹¿Ù HP ¢Í§à¨éÒ¶éÒà¨éÒãªéÁÑ¹. ÁÑ¹à¤ÂªèÇÂªÕÇÔµ¢éÒäÇé. ¢éÒäÁèÃÙéÇèÒÁÑ¹ä»µÑé§ÍÂÙèµÃ§¹Ñé¹ä´éÍÂèÒ§äÃ...";
		next;
		mes "[Lunar]";
		mes "¢éÒ»Ô´à¤Ã×èÍ§àÁ×èÍäÁèÁÕã¤ÃãªéÁÑ¹, áµè¢éÒ¨ÐãËéà¨éÒãªéà»ç¹¡Ã³Õ¾ÔàÈÉ.";
		next;
		mes "[Lunar]";
		mes "´ÙáÅµÑÇàÍ§áÅÐãªéà¤Ã×èÍ§àÁ×èÍ¨Óà»ç¹´éÇÂ!!";
		delitem 22687,20;// Sentimental Fragment
		Zeny = Zeny - 150000;
		if (isbegin_quest(14683) > 0)
			erasequest 14683;
		setquest 14683;// Mysterious Device
		close2;
		warp "lhz_dun_n",162,254;
		end;
	case 2:
		mes "[Lunar]";
		mes "à¨éÒÁÕ¢Í§áÅÐà§Ô¹¤ÃºäËÁ ??";
		next;
		if (countitem(22687) < 30 || Zeny < 2000000) {
			mes "[Lunar]";
			mes "´ÙÊÔ.";
			next;
			mes "[Lunar]";
			mes "ÁÑ¹äÁè¾Í. ^0000cd30 Sentimental Fragment áÅÐ 2M Zeny^000000 ·ÕèµéÍ§ãªé. ¢éÒ¾Òà¨éÒä»¿ÃÕæäÁèä´é.";
			close;
		}
		mes "[Lunar]";
		mes "´Õ. à¨éÒÁÕ¤Ãº. ¢éÒ¨Ð¾Òà¨éÒä».";
		next;
		mes "[Lunar]";
		mes "·Ò§ÍÍ¡¤×Í´éÒ¹¹Í¡¢Í§¡Óá¾§.";
		next;
		mes "[Lunar]";
		mes "^EE0000àÂÕèÂÁ, ¢éÒ¨Ðàµ×Í¹à¨éÒÇèÒ. ·Õè¹ÕéÁÑ¹à«¿äÁèä´é, ´Ñ§¹Ñé¹àÁ×èÍà¨éÒÍÍ¡¨Ò¡à¡ÁËÃ×Íà¹çµµÑ´, à¨éÒ¨Ðä»ÍÂÙè·Õè¨Ø´ save point.";
		close2;
		delitem 22687,30;
		Zeny = Zeny - 2000000;
		warp "lhz_d_n2",60,44;
		end;
	case 3:
		mes "[Lunar]";
		mes "¢éÒ¢Ø´´Ô¹à¾×èÍËÒ¢Í§¡Ô¹áÅÐ¢éÒ¡ç¾ººÒ§ÍÂèÒ§·Õè´Õ¡ÇèÒ¢Í§¡Ô¹.";
		next;
		mes "[Lunar]";
		mes "¤¹à»ç¹äÁèÊÒÁÒÃ¶ÍÂÙèÃÍ´ä´é·Õè¹Ñè¹. ÁÑ¹àµçÁä»´éÇÂ¤¹µÒÂ.";
		next;
		mes "[Lunar]";
		mes "ÁÕ¢èÒÇÅ×ÍÇèÒ..ºÒ§¤¹ä»·Õè¹Ñè¹áÅéÇäÁèä´é¡ÅÑºÁÒÍÕ¡àÅÂ...";
		next;
		mes "[Lunar]";
		mes "¢éÒÃÙéÊÖ¡¡ÅÑÇáµè..ÁÑ¹¨Ð¡ÅÒÂà»ç¹Ê¶Ò¹·ÕèÂÍ´¹ÔÂÁÊÓËÃÑº¹Ñ¡¼¨­ÀÑÂ·Õè¨Ðä»¼¨­ÀÑÂ.";
		next;
		mes "[Lunar]";
		mes "Ê¶Ò¹·Õèæ¢éÒÁÒ¶Ö§ ^0000cd¾ÃéÍÁ¡Ñº¤ÇÒÁàª×èÍÁÑè¹á»Å¡ æ^000000.";
		next;
		mes "[Lunar]";
		mes "¢éÒÇÔè§ËÅºàËÅèÒ¤¹µÒÂ·Õè¾ÂÒÂÒÁ¨Ð¦èÒ¢éÒ.";
		next;
		mes "[Lunar]";
		mes "áµèáÅéÇ¢éÒ¡çËÅ§áÅÐÅéÁÅ§ã¹·Õè·Õèá»Å¡»ÃÐËÅÒ´.";
		next;
		mes "[Lunar]";
		mes "ÁÑ¹à»ç¹·Õèæ¤ÅéÒÂ¡Ñº¤¹µÒÂÍÂÙè ^0000cdáµèÁÑ¹ãËé¤ÇÒÁÃÙéÊÖ¡^000000. ¹èÒ¡ÅÑÇ, ´Ñ§¹Ñé¹¢éÒ¨Ö§ÍÍ¡ä»·Ñ¹·Õ.";
		next;
		mes "[Lunar]";
		mes "¢éÒ¨Ð¾Òà¨éÒä»¶éÒà¨éÒãËéà§Ô¹áÅÐ¢Í§ÁÒ.";
		next;
		mes "[Lunar]";
		mes "ÁÑ¹äÁè§èÒÂàÅÂ¶éÒà¨éÒ¨Ðä»àÍ§.";
		close;
	case 4:
		mes "[Lunar]";
		mes "ÁÒàÂÕèÂÁ¢éÒä´éµÅÍ´. ¾Ç¡àÃÒäÁèÁÕÍÐäÃ¨ÐàÊÕÂáÅéÇ.";
		close;
	}
}

lighthalzen,327,216,3	script	Crevice#1	4_CRACK,{
	end;
OnInit:
	initnpctimer;
	end;
OnTimer5000:
	specialeffect EF_AGIUP3;
	end;
OnTimer6000:
	initnpctimer;
	end;
}

// Dungeon exit
lhz_dun_n,96,203,3	script	Dungeon gateway#1	4_CRACK,{
	if (select( "äÁèÍÍ¡¨Ò¡´Ñ¹à¨ÕéÂ¹.", "ÍÍ¡¨Ò¡´Ñ¹à¨ÕéÂ¹." ) == 1) {
		mes "- à¨éÒÂÑ§ÁÕÊÔè§·Õè¨ÐµéÍ§·Ó·Õè¹Õè -";
		close;
	}
	warp "lighthalzen",310,228;
	end;
OnInit:
	initnpctimer;
	end;
OnTimer5000:
	specialeffect EF_AGIUP3;
	end;
OnTimer6000:
	initnpctimer;
	end;
}

// Lighthalzen Exchange NPCs
lighthalzen,319,213,4	script	Veteran Adventurer#JCv2	4_M_MELODY,2,2,{
	disable_items;
	mes "[Veteran Adventurer]";
	mes "âÍé! à¨éÒµéÍ§¡ÒÃáÅ¡¨Ôµã¨ËÃ×ÍàÈÉ¤ÇÒÁÃÔÉÂÒÅÐ ?";
	next;
	setarray .@items[0],
		6469,200,	// Will of Warrior
		6470,200,	// Blood Thirst
		6471,300;	// Ghost Chill
	.@color$[0] = countitem(6820) < 200 ? "^777777" : "^000000";
	.@color$[1] = countitem(6820) < 300 ? "^777777" : "^000000";
	.@s = select( "¿Ñ§àÃ×èÍ§ÃÒÇ", .@color$[0] + "1 Will of Warrior (200 Energy pieces)", .@color$[0] + "1 Blood Thirst (200 energy pieces)", .@color$[1] + "1 Ghost Chill (300 energy pieces)^000000" ) - 2;
	if (.@s == -1) {
		emotion ET_QUESTION;
		mes "[Veteran Adventurer]";
		mes "à¨éÒ´ÙàËÁ×Í¹¤¹ÁÕàÇÅÒÇèÒ§, ãªè»Ð ? àÂÕèÂÁ, §Ò¹¢Í§¢éÒ¡çÁÕäÁèÁÒ¡´éÇÂÇÑ¹¹Õé...";
		next;
		mes "[Veteran Adventurer]";
		mes "ÇÑ¹Ë¹Öè§, ÍÂÙèæËÑÇË¹éÒÊÁÒ¤Á¡çÁÒËÒ¢éÒ·ÕèÊÁÒ¤Á...";
		next;
		mes "[Veteran Adventurer]";
		mes "'^1F294D¢éÒ¨Ð·ÓãËé·Ø¡¤¹ã¹ÊÁÒ¤ÁÊÇÁãÊè Cloak of the Fallen Soldier!!^000000'.";
		next;
		mes "[Veteran Adventurer]";
		mes "´Ñ§·Õèà¨éÒÃÙé, ÍØ»¡Ã³ì¹ÕéµéÍ§¡ÒÃÇÑÊ´Ø¨Ó¹Ç¹ÁÒ¡, ´Ñ§¹Ñé¹ÊÁÒªÔ¡·Ø¡¤¹¨Ö§äÁèÁÕ·Ò§àÅ×Í¡Í×è¹¹Í¡¨Ò¡µéÍ§µÔ´ÍÂÙèã¹´Ñ¹à¨ÕéÂ¹áÅÐ¶Ù¡ºÑ§¤ÑºãËé·Ó§Ò¹.";
		next;
		mes "[Veteran Adventurer]";
		mes "à¨éÒäÁèÁÕ·Ò§ÃÙéàÅÂÇèÒâª¤¢Í§à¨éÒ¨Ðà¨Í¡ÑºÍÐäÃ. ¢éÒ·Ó§Ò¹¢Ø´àËÁ×Í§´éÇÂ¤ÇÒÁÁØè§ÁÑè¹áÅéÇ¡çà¨Í¡ÑºªÔé¹ÊèÇ¹·ÕèËÒÂÒ¡¨Ó¹Ç¹ÁÒ¡.";
		next;
		mes "[Veteran Adventurer]";
		mes "¼ÙéªèÇÂËÑÇË¹éÒÊÁÒ¤Á Êè§¢éÒä»áÅ¡à»ÅÕèÂ¹ÊÔè§¢Í§µèÒ§æ¡Ñº¤¹Í×è¹æ.";
		next;
		mes "[Veteran Adventurer]";
		mes "á¹è¹Í¹ÇèÒ, ¨Ó¹Ç¹·ÕèãªéáÅ¡¶Ù¡µÑ´ÊÔ¹ã¨â´ÂËÑÇË¹éÒÊÁÒ¤Á";
		mes "'^1F294D¢éÒ¨ÐäÁèÂÍÁÃÑºËÒ¡µèÓ¡ÇèÒ¨Ó¹Ç¹¹Õé!!^000000'...";
		next;
		emotion ET_HNG;
		mes "[Veteran Adventurer]";
		mes "¼ÙéªèÇÂËÑÇË¹éÒÊÁÒ¤Á à¤ÂÅÍ§·Õè¨ÐâÂ¹´Ô¹ãÊèµÒËÑÇË¹éÒÊÁÒ¤Á. ¾Ç¡àÃÒ¾ÂÒÂÒÁÍÂèÒ§Ë¹Ñ¡à¾×èÍËÂØ´ËÅèÍ¹äÇé.";
		next;
		mes "[Veteran Adventurer]";
		mes "¢éÒà´ÒÇèÒ¾Ç¡àÃÒÊÒÁÒÃ¶´ÙáÅä´éÍÂèÒ§ÃÇ´àÃçÇËÒ¡»ÃÑº¨Ó¹Ç¹ãËé¹éÍÂÅ§. (¡ÃÐ«Ô¡)...ÁÑ¹¤§¨Ðà¡Ô´¢Öé¹ä´é.";
		close;
	}
	.@s *= 2;
	mes "[Veteran Adventurer]";
	mes "^3300661 " + getitemname(.@items[.@s]) + "^000000 áÅ¡à»ÅÕèÂ¹¡Ñº ^CC3333" + .@items[.@s+1] + " Energy Pieces^000000.";
	next;
	if (select( "áÅ¡.", "äÁèáÅ¡." ) == 2) {
		emotion ET_OTL;
		mes "[Veteran Adventurer]";
		mes "ÍÐäÃ ?...¢éÒ¤Ô´ÇèÒà¨éÒÁÒà¾×èÍáÅ¡à»ÅÕèÂ¹¹Ðà¹ÕèÂ.";
		close;
	}
	while(true) {
		if (countitem(6820) < .@items[.@s+1]) {
			emotion ET_SORRY;
			mes "[Veteran Adventurer]";
			mes "¢Íâ·É´éÇÂ. ¢éÒäÁèÁÕ·Ò§àÅ×Í¡à¾ÃÒÐËÑÇË¹éÒÊÁÒ¤ÁÊÑè§ÁÒ. à¨éÒµéÍ§ÁÕ " + .@items[.@s+1] + " , ¶éÒà¢Ò»¯ÔàÊ¸, ¢éÒªèÇÂäÁèä´é¨ÃÔ§æ.";
			close;
		}
		delitem 6820, .@items[.@s+1];// Energy Pieces
		getitem .@items[.@s],1;
		mes "[Veteran Adventurer]";
		mes "à¨éÒµéÍ§¡ÒÃáÅ¡à»ÅÕèÂ¹µèÍËÃ×ÍäÁè?";
		next;
		if (select( "µèÍàÅÂ.", "ËÂØ´áÅ¡à»ÅÕèÂ¹." ) == 2) {
			emotion ET_THANKS;
			mes "[Veteran Adventurer]";
			mes "¢Íº¤Ø³...¢éÒà´ÒÇèÒ¢éÒ¨ÐäÁè¶Ù¡Å§â·Éâ´ÂËÑÇË¹éÒÊÁÒ¤ÁáÅéÇ, ¢Íºã¨à¨éÒÁÒ¡.";
			close;
		}
	}
	end;

OnTouch:
	.@r = rand(4);
	if (.@r == 0)
		npctalk "¢éÒ¨ÐáÅ¡ 1 Will of Warrior ¡Ñº 200 energy pieces.", "", bc_self;
	else if (.@r == 1)
		npctalk "¢éÒ¨ÐáÅ¡ 1 Ghost Chill ¡Ñº 300 energy pieces.", "", bc_self;
	else if (.@r == 2)
		npctalk "¢éÒ¨ÐáÅ¡ 1 Blood Thirst ¡Ñº 200 energy pieces.", "", bc_self;
	else {
		emotion ET_OHNO;
		npctalk "âÍé!...·ÓäÁÁÑ¹¶Ö§ËÒàÈÉªÔé¹ÊèÇ¹ÂÒ¡¹Ñ¡ ?", "", bc_self;
	}
	end;
}

lighthalzen,312,296,4	script	Bully#JCv2	4_M_LGTPOOR,{
	disable_items;
	mes "[Bully]";
	mes "àÎé, ¤ÙèËÙ. à¨éÒ¾Í¨ÐÁÕ Energy pieces àËÅ×ÍäËÁ ? ¢éÒ¨ÐáÅ¡ÁÑ¹¡ÑºÊÔè§·Õè¤Ùè¤ÇÃ¶éÒà¨éÒµéÍ§¡ÒÃ.";
	next;
	.@s = select(
		"Listen to the story.",
		( countitem(25127) < 2000 ? "^777777" : "^000000" ) + "1 Energy Fragment (2000 Silent E Particles)",
		( countitem(25128) < 1000 ? "^777777" : "^000000" ) + "1 Energy Fragment (1000 Weak E Particles)",
		( countitem(25129) < 500 ? "^777777" : "^000000" ) + "1 Energy Fragment (500 Unstable E Particles)",
		( countitem(25130) < 500 ? "^777777" : "^000000" ) + "1 Energy Fragment (500 Sinister E Particles)",
		( countitem(25131) < 50 ? "^777777" : "^000000" ) + "1 Energy Fragment (50 Fallen E Particles)",
		( countitem(6820) < 50 ? "^777777" : "^000000" ) + "1 Sentimental Fragment (50 Energy Fragments)",
		( countitem(6820) < 666 ? "^777777" : "^000000" ) + "1 Cursed Fragment (666 Energy Fragments)"
	) - 2;
	if (.@s == -1) {
		emotion ET_THINK;
		mes "[Bully]";
		mes ". . . . . . .";
		next;
		mes "[Bully]";
		mes "Ë×ÁÁÁ...¹Õé¤èÍ¹¢éÒ§¤Ò´äÁè¶Ö§.";
		mes "â´Â»¡µÔà¢Ò¨ÐÅÐàÅÂ¢éÒáÅÐä»·Ó§Ò¹¢Í§à¢Ò.";
		next;
		mes "[Bully]";
		mes "¢Íâ·É´éÇÂ, áµè¢éÒäÁèÁÕÍÐäÃ¨Ð¾Ù´. ·Õè¢éÒÁÒ·Ó§Ò¹¹Õéà¾ÃÒÐÁÑ¹·Óà§Ô¹ãËé¢éÒÁÒ¡ÁÒÂ.";
		close;
	}
	setarray .@exchange[0],
		6820, 25127,2000,	// Silent Energy Particle -> Energy Fragment
		6820, 25128,1000,	// Weak Energy Particles -> Energy Fragment
		6820, 25129,500,	// Unstable Energy Particle -> Energy Fragment
		6820, 25130,500,	// Sinister Energy Particle -> Energy Fragment
		6820, 25131,50,		// Fallen Energy Particle -> Energy Fragment
		22687, 6820,50,		// Energy Fragment -> Sentimental Fragment
		23016, 6820,666;	// Energy Fragment -> Cursed Fragment
	.@index = .@s * 3;
	mes "[Bully]";
	mes "à¨éÒµéÍ§¡ÒÃ·Õè¨ÐáÅ¡ ^330066" + .@exchange[.@index+2] + " " + getitemname(.@exchange[.@index+1]) + "^000000 ¡Ñº ^CC33331 " + getitemname(.@exchange[.@index]) + "^000000 ãªèäËÁ ?";
	next;
	if (select( "áÅ¡.", "äÁèáÅ¡." ) == 2) {
		emotion ET_HNG;
		mes "[Bully]";
		mes "àÂÕèÂÁ...¶éÒà¨éÒäÁèªÍº, ¡çÍÂèÒ¡Ñ§ÇÅ.";
		close;
	}
	while(true) {
		if (countitem(.@exchange[.@index+1]) < .@exchange[.@index+2]) {
			emotion ET_SCRATCH;
			mes "[Bully]";
			mes "äÁè...äÁè...à¨éÒáÅ¡äÁèä´é.";
			mes "¢éÒºÍ¡à¨éÒáÅéÇÇèÒà¨éÒµéÍ§áÅ¡ÁÑ¹´éÇÂ " + .@exchange[.@index+2] + " (item)s.";
			close;
		}
		delitem .@exchange[.@index+1], .@exchange[.@index+2];
		getitem .@exchange[.@index], 1;
		emotion ET_SEXY;
		mes "[Bully]";
		mes "âÍé ¢Íº¤Ø³. à¨éÒµéÍ§¡ÒÃáÅ¡à»ÅÕèÂ¹àÅÂäËÁ ?";
		next;
		if (select( "áÅ¡àÅÂ.", "ËÂØ´áÅ¡à»ÅÕèÂ¹." ) == 2) {
			mes "[Bully]";
			mes "àÁ×èÍã´·Õèà¨éÒÁÕ energy piece àËÅ×Í, ãËéÁÒËÒ¢éÒ.";
			close;
		}
	}
}

// Enchants NPCs
lhz_dun_n,145,265,4	script	Silent Mind#JCv2	4_CENERE,{
	disable_items;
	mes "[Silent Mind]";
	mes ". . . . . .!";
	mes "...";
	mes "^FF0000*à¨éÒÊÒÁÒÃ¶ÃÑº Death's Chest ä´éàÁ×èÍà¨éÒãËéÇÔ­­Ò³·ÕèàËÁ×Í¹¡Ñ¹ÁÒ 3 ÍÑ¹.*^000000";
	next;
	setarray .@item[0],6814,6815,6816,6817,6818,6819;
	for ( .@i = 0; .@i < 6; ++.@i ) {
		if (countitem(.@item[.@i]) < 3)
			.@menu$ += "^777777äÁè¾Í " + getitemname(.@item[.@i]) + ".^000000:";
		else
			.@menu$ += "Êè§ÁÍº 3 " + getitemname(.@item[.@i]) + ".:";
	}
	.@s = select(.@menu$) - 1;
	while(true) {
		if (countitem(.@item[.@s]) < 3) {
			emotion ET_HNG;
			mes "[Silent Mind]";
			mes "!. . . . . .";
			mes "^FF0000*à¨éÒµéÍ§ÁÕÇÔ­­Ò³·ÕèàËÁ×Í¹¡Ñ¹ÁÒ 3 ÍÑ¹à¾×èÍáÅ¡¡Ñº Death's Chest.*^000000";
			close;
		}
		delitem .@item[.@s],3;
		getitem 22679,1;// Chest_of_Death
		emotion ET_HUNGRY;
		mes "[Silent Mind]";
		mes ". . . . . .";
		mes "...";
		mes "^FF0000*à¨éÒä´éÃÑº Death's Chest áÅéÇ. à¨éÒµéÍ§¡ÒÃáÅ¡µèÍËÃ×ÍäÁè?*^000000";
		next;
		if (select( "áÅ¡µèÍ.", "ËÂØ´áÅ¡." ) == 2) {
			mes "[Silent Mind]";
			mes ". . . . . .";
			close;
		}
	}
}

lhz_dun_n,134,265,2	script	Wandering Mind#JCv2	4_CENERE,{
	disable_items;
	npctalk "¢¢¢...¢éÒÒÒ...ÃÙéÊÖ¡ä´é...", "", bc_self;
	mes "[Wandering Mind]";
	mes "¢¢¢...¢éÒÒÒ...ÃÙéÊÖ¡ä´é...¶Ö§¤ÇÒÁá¤é¹...ÍÑ¹ÁÒ¡ÁÒÂ...¢Í§¼Ùé¤¹...";
	next;
	npctalk "¢éÒ...¤×Í...ã¤Ã ?...", "", bc_self;
	mes "[Wandering Mind]";
	mes "·Õè¹Õé...·ÕèäË¹ ?...·ÕèäË¹¡Ñ¹ ?...ÍéÒ¡¡¡...¢éÒ...¤×Í...ã¤Ã ?...·ÓäÁ¢éÒ...¨ÓäÁèä´é...";
	next;
	mes "[Wandering Mind]";
	mes "¢éÒµéÍ§¡ÒÃ...¾ÅÑ§...·Õèá¢ç§á¡Ãè§...ã¹...¡ÒÃá¡éá¤é¹...ÁÑ¹¨ÐªèÇÂ...¢éÒ...áÅÐà¨éÒ...·Ñé§¤Ùè...¢¢¢...";
	next;
	switch( select( "ÍÍ¿ Old Helmet", "ÅºÍÍ¿ Old Helmet", "ÃÒÂÅÐàÍÕÂ´ÍÍ¿ Old Helmet" ) ) {
	case 1:
		npctalk "Êè§ÁÍº...¤ÇÒÁá¤é¹...¤ÇÒÁá¤é¹ÁÒ...", "", bc_self;
		mes "[Wandering Mind]";
		mes "ÍÒÒÒ...ËÔËÔ...Êè§ÁÍº...¤ÇÒÁá¤é¹...¤ÇÒÁá¤é¹...·Õèá¢ç§á¡Ãè§ÁÒ...¢éÒ¨ÐÍÍ¿...¾ÅÑ§·Õè¾ÔàÈÉ...Å§ã¹ËÁÇ¡ãËé...";
		mes "^FF0000*¶éÒà¨éÒ¹Ó Cursed Fragment ÁÒ, à¨éÒÊÒÁÒÃ¶ÍÍ¿ËÁÇ¡ä´é.*^000000";
		next;
		.@equip_id = getequipid(EQI_HEAD_TOP);
		switch(.@equip_id) {
			case 18971:// Old_Rune_Circlet
			case 18972:// Old_Mitra
			case 18973:// Old_Driver_Band_R
			case 18974:// Old_Driver_Band_Y
			case 18975:// Old_Shadow_Handicraft
			case 18976:// Old_Minstrel_Song_Hat
			case 18977:// Old_Midas_Whisper
			case 18978:// Old_Magic_Stone_Hat
			case 18979:// Old_Blazing_Soul
			case 18980:// Old_Wind_Whisper
			case 18981:// Old_Dying_Swan
			case 18982:// Old_Circlet_Of_Bone
			case 18983:// Old_Protect_Of_Crown
			case 18984:// Old_Camo_RabbitHood
				break;
			default:
				npctalk "·ÓÅÒÂÁÑ¹...·ÓÅÒÂÁÑ¹...", "", bc_self;
				mes "[Wandering Mind]";
				mes "ÁÑ¹à»ç¹...¤ÇÒÁ¹èÒÊ¹ã¨...ã¹ËÁÇ¡...ÁÑ¹äÁèËÍÁËÇÒ¹...·Õè¨Ðä´éÃÑº¾ÅÑ§¾ÔàÈÉ...à¨éÒµéÍ§¡ÒÃ...·ÓÅÒÂÁÑ¹...? ¢¢¢...";
				mes "^FF0000*ã¹¡ÒÃÍÍ¿ Old Helmet ¨Ðãªé Cursed Fragment à·èÒ¹Ñé¹.*^000000";
				close;
		}
		mes "[Wandering Mind]";
	
		.@requirement = 10;	// 10 Cursed Fragments by default
		setarray .@card[0], getequipcardid(EQI_HEAD_TOP,0), getequipcardid(EQI_HEAD_TOP,1), getequipcardid(EQI_HEAD_TOP,2), getequipcardid(EQI_HEAD_TOP,3);
		.@refine = getequiprefinerycnt(EQI_HEAD_TOP);
	
		if (.@card[3] == 0) {
			.@slot = 3;
			mes "¾Ç¡àÃÒ...¨ÐàÃÔèÁ...áººÊºÒÂæ ?...ÅÍ§...âª¤¢Í§à¨éÒ...ÍÒ..ËÔËÔ...";
			mes "^FF0000*ã¹¡ÒÃÍÍ¿ªèÍ§·Õè 4. ¨ÐÊØèÁÍÍ¿à»ç¹Ë¹Öè§ã¹ 6 ÊàµµÑÊ.*^000000";
		}
		else if (.@card[2] == 0) {
			.@slot = 2;
			mes "ÍÒ...ËÔËÔ...´Ù...àËÁ×Í¹à¨éÒ...¨Ð...ÍÍ¿...¤ÃÑé§áÃ¡ä»áÅéÇ ?...";
			mes "^FF0000*ã¹¡ÒÃÍÍ¿ªèÍ§·Õè 3. ¨ÐÊØèÁÍÍ¿à»ç¹Ë¹Öè§ã¹ 6 ÊàµµÑÊ.*^000000";
		}
		else if (.@card[1] == 0) {
			.@slot = 1;
			mes "ÍÒ...ËÔËÔ...¶éÒà¡Ô´ÁÕ...Ë¹·Ò§...·Õè¨Ðä´éÃÑº...¾ÅÑ§·Õèá¢ç§á¡Ãè§ÁÒ¡¢Öé¹...¤ÇÃ¨Ð...µÑ´ÊÔ¹ã¨...µÍ¹¹Õé...";
			mes "^FF0000*ã¹¡ÒÃÍÍ¿ªèÍ§·Õè 2.";
			mes "à¨éÒÍÒ¨ä´éÍÍ¿ Mettle, Magic Essence, Acute, Master Archer, Adamantine, Affection, ÁÑ¹ÊÒÁÒÃ¶àÅ×èÍ¹¢Ñé¹¢Öé¹ä´é.*^000000";
		}
		else {
			// enchant leveling
			switch( .@card[1] ) {
			case 29061:	// Ambition1Lv
			case 29071:	// Tab1Lv
			case 29081:	// Expect1Lv
			case 29091:	// ArchLine1Lv
			case 29101:	// Steel1Lv
			case 29111:	// Mercy1Lv
				mes "ÍÒ...ËÔ...ËÔ...à¨éÒÁÑ¹...´Ç§´Õ...¢éÒÍÂÒ¡...ãËéà¨éÒÊÓàÃç¨µÅÍ´!...à¾ÃÒÐ§Ñé¹...¢éÒ¤Ô´ÇèÒ...à¨éÒ¨Ð¡ÅÑºÁÒËÒ¢éÒ...¾ÃéÍÁ¡Ñº¤ÇÒÁá¤é¹·ÕèÁÑ¹ÁÒ¡¢Öé¹...";
				.@requirement = 20;
				.@enchant_level = 1;
				.@enchant_rate = 80;
				break;
			case 29062:	// Ambition2Lv
			case 29072:	// Tab2Lv
			case 29082:	// Expect2Lv
			case 29092:	// ArchLine2Lv
			case 29102:	// Steel2Lv
			case 29112:	// Mercy2Lv
				mes "àÅ×èÍ¹¢Ñé¹...àÅàÇÅ...3 ?...¶éÒà¨éÒÊÓàÃç¨...à¨éÒ¨Ð...ä´éÃÑº...¾ÅÑ§·Õèá¢ç§á¡Ãè§ÁÒ¡¢Öé¹...áµè¶éÒà¨éÒÅéÁàËÅÇ...à¨éÒ¨ÐÊÙ­àÊÕÂ¾ÅÑ§...·Õèà¨éÒä´éÃÑºÁÒ...ÍÍ¡ä»...";
				.@requirement = 40;
				.@enchant_level = 2;
				.@enchant_rate = 70;
				break;
			case 29063:	// Ambition3Lv
			case 29073:	// Tab3Lv
			case 29083:	// Expect3Lv
			case 29093:	// ArchLine3Lv
			case 29103:	// Steel3Lv
			case 29113:	// Mercy3Lv
				mes "àÅ×èÍ¹¢Ñé¹...àÅàÇÅ...4 ?...¶éÒà¨éÒÊÓàÃç¨...à¨éÒ¨Ð...ä´éÃÑº...¾ÅÑ§·Õèá¢ç§á¡Ãè§ÁÒ¡¢Öé¹...áµè¶éÒà¨éÒÅéÁàËÅÇ...à¨éÒ¨ÐÊÙ­àÊÕÂ¾ÅÑ§...·Õèà¨éÒä´éÃÑºÁÒ...ÍÍ¡ä»...";
				.@requirement = 50;
				.@enchant_level = 3;
				.@enchant_rate = 50;
				break;
			case 29064:	// Ambition4Lv
			case 29074:	// Tab4Lv
			case 29084:	// Expect4Lv
			case 29094:	// ArchLine4Lv
			case 29104:	// Steel4Lv
			case 29114:	// Mercy4Lv
				mes "àÅ×èÍ¹¢Ñé¹...àÅàÇÅ...5 ?...à¨éÒ¾ÃéÍÁ...·Õè¨Ð¤Çº¤ØÁ...¾ÅÑ§ÍÑ¹...ÂÔè§ãË­è...ËÃ×ÍÂÑ§ ?...áµè¶éÒà¨éÒÅéÁàËÅÇ...¤§äÁèÍÂÒ¡àËç¹...¼Å...·Õè¨Ðä´éÃÑº...";
				.@requirement = 70;
				.@enchant_level = 4;
				.@enchant_rate = 20;
				break;
			case 29065:	// Ambition5Lv
			case 29075:	// Tab5Lv
			case 29085:	// Expect5Lv
			case 29095:	// ArchLine5Lv
			case 29105:	// Steel5Lv
			case 29115:	// Mercy5Lv
				mes "àÅ×èÍ¹¢Ñé¹...àÅàÇÅ...6 ?...à¨éÒ¾ÃéÍÁ...·Õè¨Ð¤Çº¤ØÁ...¾ÅÑ§ÍÑ¹...ÂÔè§ãË­è...ËÃ×ÍÂÑ§ ?...áµè¶éÒà¨éÒÅéÁàËÅÇ...¤§äÁèÍÂÒ¡àËç¹...¼Å...·Õè¨Ðä´éÃÑº...";
				.@requirement = 100;
				.@enchant_level = 5;
				.@enchant_rate = 20;	// unknown rates
				break;
			case 29066:	// Ambition6Lv
			case 29076:	// Tab6Lv
			case 29086:	// Expect6Lv
			case 29096:	// ArchLine6Lv
			case 29106:	// Steel6Lv
			case 29116:	// Mercy6Lv
				// custom text
				mes "àÅ×èÍ¹¢Ñé¹...àÅàÇÅ...7 ?...à¨éÒ¾ÃéÍÁ...·Õè¨Ð¤Çº¤ØÁ...¾ÅÑ§ÍÑ¹...ÂÔè§ãË­è...ËÃ×ÍÂÑ§ ?...áµè¶éÒà¨éÒÅéÁàËÅÇ...¤§äÁèÍÂÒ¡àËç¹...¼Å...·Õè¨Ðä´éÃÑº...";
				.@requirement = 150;
				.@enchant_level = 6;
				.@enchant_rate = 20;	// unknown rates
				break;
			case 29067:	// Ambition7Lv
			case 29077:	// Tab7Lv
			case 29087:	// Expect7Lv
			case 29097:	// ArchLine7Lv
			case 29107:	// Steel7Lv
			case 29117:	// Mercy7Lv
				// custom text
				mes "àÅ×èÍ¹¢Ñé¹...àÅàÇÅ...8 ?...à¨éÒ¾ÃéÍÁ...·Õè¨Ð¤Çº¤ØÁ...¾ÅÑ§ÍÑ¹...ÂÔè§ãË­è...ËÃ×ÍÂÑ§ ?...áµè¶éÒà¨éÒÅéÁàËÅÇ...¤§äÁèÍÂÒ¡àËç¹...¼Å...·Õè¨Ðä´éÃÑº...";
				.@requirement = 250;
				.@enchant_level = 7;
				.@enchant_rate = 20;	// unknown rates
				break;
			case 29068:	// Ambition8Lv
			case 29078:	// Tab8Lv
			case 29088:	// Expect8Lv
			case 29098:	// ArchLine8Lv
			case 29108:	// Steel8Lv
			case 29118:	// Mercy8Lv
				// custom text
				mes "àÅ×èÍ¹¢Ñé¹...àÅàÇÅ...9 ?...à¨éÒ¾ÃéÍÁ...·Õè¨Ð¤Çº¤ØÁ...¾ÅÑ§ÍÑ¹...ÂÔè§ãË­è...ËÃ×ÍÂÑ§ ?...áµè¶éÒà¨éÒÅéÁàËÅÇ...¤§äÁèÍÂÒ¡àËç¹...¼Å...·Õè¨Ðä´éÃÑº...";
				.@requirement = 500;
				.@enchant_level = 8;
				.@enchant_rate = 20;	// unknown rates
				break;
			case 29069:	// Ambition9Lv
			case 29079:	// Tab9Lv
			case 29089:	// Expect9Lv
			case 29099:	// ArchLine9Lv
			case 29109:	// Steel9Lv
			case 29119:	// Mercy9Lv
				// custom text
				mes "àÅ×èÍ¹¢Ñé¹...àÅàÇÅ...10 ?...à¨éÒ¾ÃéÍÁ...·Õè¨Ð¤Çº¤ØÁ...¾ÅÑ§ÍÑ¹...ÂÔè§ãË­è...ËÃ×ÍÂÑ§ ?...áµè¶éÒà¨éÒÅéÁàËÅÇ...¤§äÁèÍÂÒ¡àËç¹...¼Å...·Õè¨Ðä´éÃÑº...";
				.@requirement = 1000;
				.@enchant_level = 9;
				.@enchant_rate = 20;	// unknown rates
				break;
			case 29070:	// Ambition10Lv
			case 29080:	// Tab10Lv
			case 29090:	// Expect10Lv
			case 29100:	// ArchLine10Lv
			case 29110:	// Steel10Lv
			case 29120:	// Mercy10Lv
				// custom text
			default:
				mes "ÍÒÒ ËÔËÔ...ÁÑ¹à»ç¹ä»äÁèä´é...·Õè¨Ðä´é¾ÅÑ§...ÃÐ´Ñº¹Õé...Ë¹·Ò§à´ÕÂÇ¤×Í...ÅºÍÍ¿...";
				mes "^FF0000*Mettle, Magic Spirit, Vigor, Bull's Eye, Adamantine, Benevolence";
				mes "à¨éÒÊÒÁÒÃ¶àÅ×èÍ¹àÅàÇÅÍÍ¿ä´éàÁ×èÍÍØ»¡Ã³ìä´éÍÍ¿áÅéÇ.*^000000";
				close;
			}
			.@slot = 999;
		}
		next;
		mes "[Wandering Mind]";
		mes "ÍÂèÒ§äÃ¡çµÒÁ...¡èÍ¹·ÕèÁÑ¹¨Ðà¡Ô´¢Öé¹...¢éÒµéÍ§µÃÇ¨ÊÍº...ÇèÒà¨éÒÁÕ...Cursed Fragments ¾ÍËÃ×Íà»ÅèÒ...";
		next;
		mes "[Wandering Mind]";
		mes "Cursed...Fragments..." + .@requirement + " ÍÑ¹...¤×Í...¨Ó¹Ç¹·Õè...¢éÒµéÍ§¡ÒÃ...ã¹¡ÒÃÍÍ¿...ÁÑ¹ ?...¢¢...¢¢...";
		mes "^FF0000*ã¹¡ÒÃÍÍ¿, " + .@requirement + " Cursed Fragment(s) ¤×Í ·ÕèµéÍ§ãªé.*^000000";
		next;
		if (select( "¨èÒÂ¤èÒºÃÔ¡ÒÃ.", "äÁè¨èÒÂ." ) == 2) {
			mes "[Wandering Mind]";
			mes "¢...¢¢...´ÙàËÁ×Í¹...ÇèÒà¨éÒ...ÂÑ§äÁè¾ÃéÍÁ...·Õè¨ÐÃÑº¾ÅÑ§ÍÑ¹ÂÔè§ãË­è...µÍ¹¹Õé...";
			close;
		}
		if (countitem(23016) < .@requirement) {// Cursed Fragment
			mes "[Wandering Mind]";
			mes "¢...¢¢...à¨éÒ...á¡Åé§...¢éÒÃÖ ?...à¨éÒ...¡ÃÐËÒÂ...ã¹¾ÅÑ§...áµèà¨éÒ...¡ÅÑºäÁèàµÃÕÂÁ¾ÃéÍÁ ?...";
			mes "^FF0000*ã¹¡ÒÃÍÍ¿, Cursed Fragment(s) 10 ÍÑ¹ ¤×Í ·ÕèµéÍ§ãªé.";
			mes "µÃÇ¨´Ù¨Ó¹Ç¹¢Í§ Cursed Fragments ¢Í§à¨éÒÍÕ¡¤ÃÑé§.*^000000";
			close;
		}
		mes "[Wandering Mind]";
		mes "ÍÒÒ..ËÔËÔ...ÁÑ¹à»ç¹...¾ÅÑ§ã¹¡ÒÃá¡éá¤é¹...¢éÒ¤Ô´ÇèÒ...¾ÅÑ§¹Õé...ÂÑ§á¢ç§á¡Ãè§...äÁè¾Í...";
		mes "^FF0000*ÃÐ´Ñº¡ÒÃµÕºÇ¡, ¡ÒÃì´, ¢Í§ÍØ»¡Ã³ì¨ÐäÁèËÒÂä». ÍÂèÒ§äÃ¡çµÒÁ, àÅàÇÅÍÍ¿ÍÒ¨Å´Å§ä´é, ¢Öé¹ÍÂÙè¡ÑºÁÑ¹¨ÐÊÓàÃç¨ËÃ×ÍÅéÁàËÅÇ.*^000000";
		next;
		if (select( "´Óà¹Ô¹¡ÒÃÍÍ¿.", "äÁèÍÍ¿áÅéÇ." ) == 2) {
			mes "[Wandering Mind]";
			mes "¢...¢¢...´ÙàËÁ×Í¹...ÇèÒà¨éÒ...ÂÑ§äÁè¾ÃéÍÁ...·Õè¨ÐÃÑº¾ÅÑ§ÍÑ¹ÂÔè§ãË­è...µÍ¹¹Õé...";
			close;
		}
		progressbar "000000",1;
		delitem 23016, .@requirement;// Cursed Fragment

		// anti-hack
		if (callfunc("F_IsEquipIDHack", EQI_HEAD_TOP, .@equip_id) || callfunc("F_IsEquipCardHack", EQI_HEAD_TOP, .@card[0], .@card[1], .@card[2], .@card[3]) || callfunc("F_IsEquipRefineHack", EQI_HEAD_TOP, .@refine))
			close;

		switch(.@slot) {
		case 3:
		case 2:
			setarray .@enchant[0],
				4700,	// Strength1
				4701,	// Strength2
				4702,	// Strength3
				4703,	// Strength4
				4704,	// Strength5
				4710,	// Inteligence1
				4711,	// Inteligence2
				4712,	// Inteligence3
				4713,	// Inteligence4
				4714,	// Inteligence5
				4720,	// Dexterity1
				4721,	// Dexterity2
				4722,	// Dexterity3
				4723,	// Dexterity4
				4724,	// Dexterity5
				4730,	// Agility1
				4731,	// Agility2
				4732,	// Agility3
				4733,	// Agility4
				4734,	// Agility5
				4740,	// Vitality1
				4741,	// Vitality2
				4742,	// Vitality3
				4743,	// Vitality4
				4744,	// Vitality5
				4750,	// Luck1
				4751,	// Luck2
				4752,	// Luck3
				4753,	// Luck4
				4754;	// Luck5
			.@card[.@slot] = .@enchant[ rand( getarraysize(.@enchant) ) ];	// unknown rates
			break;
		case 1:
			setarray .@enchant[0],
				4703,	// Strength4
				4704,	// Strength5
				4713,	// Inteligence4
				4714,	// Inteligence5
				4723,	// Dexterity4
				4724,	// Dexterity5
				4733,	// Agility4
				4734,	// Agility5
				4743,	// Vitality4
				4744,	// Vitality5
				4753,	// Luck4
				4754,	// Luck5
				29061,	// Ambition1Lv
				29071,	// Tab1Lv
				29081,	// Expect1Lv
				29091,	// ArchLine1Lv
				29101,	// Steel1Lv
				29111;	// Mercy1Lv
			.@card[1] = .@enchant[ rand( getarraysize(.@enchant) ) ];	// unknown rates
			break;
		case 999:
			// enchant leveling
			if (.@enchant_rate > rand(100))
				.@level_dt = 1;
			else
				.@level_dt = -1;
			.@enchant_level += .@level_dt;
			.@card[1] += .@level_dt;
			if (.@card[1] < 29061 || .@card[1] > 29120) {
				mes "[Wandering Mind]";
				mes "ºÒ§ÊÔè§·ÕèàÅÇÃéÒÂà¡Ô´¢Öé¹.";
				close;
			}
			if (.@enchant_level < 1 || .@enchant_level > 10) {
				// item not deleted
				specialeffect2 EF_SUI_EXPLOSION;
				mes "[Wandering Mind]";
				mes "¢..ÍéÒ¡¡¡...!! ¾ÅÑ§ã¹¡ÒÃá¡éá¤é¹...ä´éà¢éÒÊÙè...¤ÇÒÁºéÒ¤ÅÑè§...ÍÂèÒ§äÃ¡çµÒÁ...âª¤´Õ·ÕèÁÑ¹äÁèä´éÃÐàºÔ´à¾ÃÒÐ¾ÅÑ§...·Õè....ÍèÍ¹áÍ.";
				close;
			}
			break;
		default:
			mes "[Wandering Mind]";
			mes "ºÒ§ÊÔè§·ÕèàÅÇÃéÒÂà¡Ô´¢Öé¹.";
			close;
		}
		delequip EQI_HEAD_TOP;
		getitem2 .@equip_id,1,1,.@refine,0,.@card[0],.@card[1],.@card[2],.@card[3];
		if (.@level_dt == -1) {// can only happens during enchant leveling
			specialeffect2 EF_SUI_EXPLOSION;
			mes "[Wandering Mind]";
			mes "¢..ÍéÒ¡¡¡...!! ¾ÅÑ§ã¹¡ÒÃá¡éá¤é¹...ä´éà¢éÒÊÙè...¤ÇÒÁºéÒ¤ÅÑè§...¾ÅÑ§...·Õèà¤Âà»ç¹...ÁÑ¹...ä´éÅ´Å§...ä»Ë¹Öè§ÃÐ´Ñº...";
			mes "^FF0000*à¹×èÍ§¨Ò¡ÍÍ¿ÅéÁàËÅÇ, àÅàÇÅÍÍ¿¨Ð¶Ù¡Å´ä»Ë¹Öè§ÃÐ´Ñº.*^000000";
			close;
		}
		specialeffect2 EF_FIREHIT;
		mes "[Wandering Mind]";
		mes "ÁÑ¹...ÊÓàÃç¨. ¢éÒÃÙéÊÖ¡ä´éÇèÒ¾ÅÑ§ã¹¡ÒÃá¡éá¤é¹ä´éá¢ç§á¡Ãè§¢Öé¹áÅéÇ.";
		mes "^FF0000*ÂÔ¹´Õ´éÇÂ. à¨éÒÍÍ¿ÊÓàÃç¨ä»´éÇÂ´Õ.*^000000";
		close;
	case 2:
		.@equip_id = getequipid(EQI_HEAD_TOP);
		switch(.@equip_id) {
			case 18971:// Old_Rune_Circlet
			case 18972:// Old_Mitra
			case 18973:// Old_Driver_Band_R
			case 18974:// Old_Driver_Band_Y
			case 18975:// Old_Shadow_Handicraft
			case 18976:// Old_Minstrel_Song_Hat
			case 18977:// Old_Midas_Whisper
			case 18978:// Old_Magic_Stone_Hat
			case 18979:// Old_Blazing_Soul
			case 18980:// Old_Wind_Whisper
			case 18981:// Old_Dying_Swan
			case 18982:// Old_Circlet_Of_Bone
			case 18983:// Old_Protect_Of_Crown
			case 18984:// Old_Camo_RabbitHood
				break;
			default:
				npctalk "·ÓÅÒÂÁÑ¹...·ÓÅÒÂÁÑ¹...", "", bc_self;
				mes "[Wandering Mind]";
				mes "ÁÑ¹à»ç¹...¤ÇÒÁ¹èÒÊ¹ã¨...ã¹ËÁÇ¡...ÁÑ¹äÁèËÍÁËÇÒ¹...·Õè¨Ðä´éÃÑº¾ÅÑ§¾ÔàÈÉ...à¨éÒµéÍ§¡ÒÃ...·ÓÅÒÂÁÑ¹...? ¢¢¢...";
				mes "^FF0000*ã¹¡ÒÃÍÍ¿ Old Helmet ¨Ðãªé Cursed Fragment à·èÒ¹Ñé¹.*^000000";
				close;
		}
		setarray .@card[0], getequipcardid(EQI_HEAD_TOP,0), getequipcardid(EQI_HEAD_TOP,1), getequipcardid(EQI_HEAD_TOP,2), getequipcardid(EQI_HEAD_TOP,3);
		.@refine = getequiprefinerycnt(EQI_HEAD_TOP);

		if (.@card[3] < 1) {// one enchant required
			npctalk "à¨éÒ...ã¨àÂç¹ÁÒ¡...", "", bc_self;
			mes "[Wandering Mind]";
			mes "¢¢¢...à¨éÒ´Ù¹Ôè§ÁÒ¡...àËÁ×Í¹äÁèà¤Â...ä´éÃÑº¾ÅÑ§...·Õè¢éÒ...ãËéà¨éÒ...ÁÒ¡èÍ¹...";
			mes "^FF0000*ËÁÇ¡¹ÕéäÁèà¤ÂÍÍ¿, ·ÓãËéÅºÍÍ¿äÁèä´é.*^000000";
			close;
		}
		npctalk "ÍÒÒ...ËÔËÔ...¢éÒ¨Ð¡Ô¹...ÁÑ¹...ÇÑ¹¹Õé...", "", bc_self;
		mes "[Wandering Mind]";
		mes "¢¢¢...à¨éÒàËÁ×Í¹...äÁèªÍºã¹¾ÅÑ§¹Õé ?...¹Ó 10 mind powers ÁÒãËé¢éÒ...áÅéÇ, ¢éÒ¨Ð·ÓãËé¾ÅÑ§...ÁÑ¹ËÒÂä»...";
		mes "^FF0000*à¨éÒµéÍ§ÁÕ 10 Sentimental Fragments ã¹¡ÒÃÅºÍÍ¿.";
		mes "ËÁÇ¡·Õè¨ÐÅºÍÍ¿, àÅàÇÅ¡ÒÃµÕºÇ¡áÅÐ¡ÒÃì´¨ÐäÁèËÒÂä», ¨Ò¡¡ÒÃÅºÍÍ¿.*^000000";
		next;
		if (select( "äÁèÊ¹ã¨.", "¨èÒÂ¤èÒºÃÔ¡ÒÃ." ) == 1) {
			npctalk "µÅÍ´ä»...", "", bc_self;
			mes "[Wandering Mind]";
			mes "¢éÒ¨Ð...ÃÍ...à¨éÒ...¶éÒà¨éÒµéÍ§¡ÒÃ¢éÒ...¢éÒ¨ÐÃÍà¨éÒ...µÅÍ´ä»...¢¢¢...";
			close;
		}
		if (countitem(22687) < 10) {// Sentimental Fragment
			mes "¢¢..¢...¶éÒà¨éÒ...äÁè¹Ó...";
			mes "10 mind powers...ÁÒ ¢éÒÍÒ¨...ÁÕ»Ñ­ËÒä´é...";
			mes "^FF0000*à¨éÒµéÍ§ÁÕ 10 Sentimental Fragments ã¹¡ÒÃÅºÍÍ¿.";
			mes "µÃÇ¨´Ù¨Ó¹Ç¹¢Í§ Sentimental Fragments ¢Í§à¨éÒÍÕ¡¤ÃÑé§.*^000000";
			close;
		}
		npctalk "¢...¢¢...", "", bc_self;
		mes "[Wandering Mind]";
		mes "àÃÕÂºÃéÍÂ!...¢éÒ...Åº...ÍÍ¿ÍÍ¡¨Ò¡...old helmet ãËéáÅéÇ...¢éÒ¤Ô´ÇèÒ...¾Ç¡àÃÒÂÑ§ÊÒÁÒÃ¶...à¡è§¢Öé¹ä´é...";
		next;
		progressbar "000000",2;
		specialeffect2 EF_FIREHIT;
		delitem 22687,10;// Sentimental Fragment

		if (callfunc("F_IsEquipIDHack", EQI_HEAD_TOP, .@equip_id) || callfunc("F_IsEquipCardHack", EQI_HEAD_TOP, .@card[0], .@card[1], .@card[2], .@card[3]) || callfunc("F_IsEquipRefineHack", EQI_HEAD_TOP, .@refine))
			close;

		delequip EQI_HEAD_TOP;
		getitem2 .@equip_id,1,1,.@refine,0,.@card[0],0,0,0;
		mes "[Wandering Mind]";
		mes "¢..¢¢...¾ÅÑ§...ã¹¡ÒÃá¡éá¤é¹...ä´é¶Ù¡...´Ù´«Ñº...ÍÍ¡ä»áÅéÇ...¢..ÍéÒ¡¡¡...";
		close;
	case 3:
		for ( .@i = 18971; .@i <= 18984; ++.@i ) {
			if (.@i < 18977)
				.@string$[0] += getitemname(.@i) + ", ";
			else if (.@i < 18984)
				.@string$[1] += getitemname(.@i) + ", ";
			else
				.@string$[2] = getitemname(.@i);
		}
		mes "[Wandering Mind]";
		mes "à¨éÒµéÍ§¡ÒÃ...¾ÅÑ§ËÃÍ ?...¶éÒ §Ñé¹, à¨éÒ...µéÍ§ÁÕ...old Helmet..";
		mes "^FF0000*à¨éÒÊÒÁÒÃ¶ÍÍ¿ÁÑ¹Å§ã¹ " + .@string$[0];
		mes "" + .@string$[1];
		mes "" + .@string$[2] + ".*^000000";
		next;
		mes "[Wandering Mind]";
		mes "¶éÒà¨éÒ...¹Ó¾ÅÑ§...ã¹¡ÒÃá¡éá¤é¹...ÁÒ ¢éÒ¨Ð...ÁÍº¾ÅÑ§...ãËéà¨éÒ...";
		mes "^FF0000*à¨éÒµéÍ§ÁÕ Cursed Fragments ã¹¡ÒÃÍÍ¿.*^000000";
		next;
		mes "[Wandering Mind]";
		mes "¢¢¢...á¹è¹Í¹ÇèÒ...¡ÒÃä´éÃÑº¾ÅÑ§...·Õè´Õ¡ÇèÒ...à¨éÒµéÍ§ÁÕ...¨Ó¹Ç¹¾ÅÑ§...ã¹¡ÒÃá¡éá¤é¹...·ÕèÁÒ¡...";
		mes "^FF0000*ã¹¡ÒÃÍÍ¿ªèÍ§·Õè 4, 3, 2 ¹Ñé¹. à¨éÒµéÍ§ÁÕ 10 Cursed Fragments àÁ×èÍà¨éÒ·Ó¡ÒÃÍÍ¿áµèÅÐªèÍ§à»ç¹¤ÃÑé§áÃ¡.*^000000";
		next;
		mes "[Wandering Mind]";
		mes "¶éÒà¨éÒÁÕ...âÍ¡ÒÊ...à¨éÒÍÒ¨¨Ð...ÊÒÁÒÃ¶ÍÑ¾à¡Ã´...ÃÐ´ÑºÍÍ¿ä´é...";
		mes "^FF0000*àÁ×èÍàÅ×èÍ¹ÃÐ´ÑºàÅàÇÅÍÍ¿, 50, 70, 100, 150, 250, 500, 1000 Cursed Fragments ¤×Í¨Ó¹Ç¹, ·ÕèãªéàÅ×èÍ¹àÅàÇÅÍÍ¿";
		mes "à¾ÔèÁ¨Ò¡ 20 Cursed Fragments ã¹¤ÃÑé§·Õè 2, áÅÐ 40 Cursed Fragments ã¹¤ÃÑé§·Õè 3.*^000000";
		close;
	}
}

lhz_dun_n,143,269,4	script	Victimized Soul's Mind#1	4_M_DEATH2,{
	disable_items;
	.@r = rand(5);
	if (.@r == 0)
		npctalk "à¨éÒ...¤×Í¤¹...·ÕèËÑ¹ÁÒËÒ...¢éÒ...·Õèà»ç¹ÁÍ¹ÊàµÍÃì...", "", bc_self;
	else if (.@r == 1)
		npctalk "ªèÇÂ¢éÒ´éÇÂ...¢éÒ¨Ð...·Ó·Ø¡ÍÂèÒ§...µÒÁ·Õèà¨éÒÊÑè§...", "", bc_self;
	else if (.@r == 2)
		npctalk "ÀÃÃÂÒáÅÐÅÙ¡ÊÒÇ...·Õè¹èÒÃÑ¡¢Í§¢éÒ...ÃÍ¢éÒ¡èÍ¹...¢éÒ¡ÓÅÑ§...¡ÅÑººéÒ¹...", "", bc_self;
	else if (.@r == 3)
		npctalk "ËÅÑ§¨Ò¡¹Ñé¹...·Ø¡ÊÔè§..ÁÑ¹...¹èÒ¡ÅÑÇ", "", bc_self;
	else
		npctalk "¢Ò...¢éÒ...á¢¹...¢éÒ...", "", bc_self;
	mes "[Victimized Soul's Mind]";
	mes "¨Ôµ...ÇÔ­­Ò³...ÍÑ¹ÁÒ¡ÁÒÂ...";
	mes "Í´Õµ...»Ñ¨¨ØºÑ¹...áÅÐ¡ÒÃá¡éá¤é¹...";
	mes "à¨éÒ¤×Íã¤Ã...";
	mes "à¨éÒÊÒÁÒÃ¶...¤Çº¤ØÁ...àËÅèÒ...¼Ùé·Ø¡¢ì·ÃÁÒ¹¨Ò¡¤ÇÒÁàÈÃéÒä´éäËÁ ?...";
	next;
	if (.@r == 0)
		npctalk "áÁéËÅÑ§¨Ò¡·Õè¢éÒµÒÂ...ËÃ×ÍÍÂÙèã¹¤ÇÒÁ½Ñ¹¢Í§¢éÒ¡Ñ¹...", "", bc_self;
	else if (.@r == 1)
		npctalk "ä´éâ»Ã´...ªèÇÂ¢éÒ´éÇÂ...àÍÒÁÑ¹ÍÍ¡ä»...ÁÕ´¹Ñé¹...ÁÑ¹·ÓãËé¢éÒ¡ÅÑÇ...", "", bc_self;
	else if (.@r == 2)
		npctalk "ä´é...â»Ã´...¾Ò¢éÒÍÍ¡ä»...¢éÒ¨ÐãËéà§Ô¹à¨éÒ...µÒÁ·Õèà¨éÒµéÍ§¡ÒÃ...", "", bc_self;
	else if (.@r == 3)
		npctalk "ËÃ×ÍÇèÒ...à¨éÒ¨Ð¡ÅÑÇ...â·ÊÐ...¢Í§¾ÃÐà¨éÒ ?...", "", bc_self;
	else
		npctalk "ÍéÒ¡...ÍÒ...ÍÑê¡...", "", bc_self;
	mes "[Victimized Soul's Mind]";
	mes "¶éÒà¨éÒ...ÊÒÁÒÃ¶...·ÓÁÑ¹ä´é...¢éÒÍÒ¨¨Ð...¢ÍãËé...à¨éÒ...ªèÇÂ¡çà»ç¹ä´é...";
	next;
	if (.@r == 0)
		npctalk "¢éÒ¨Ðà¤ÕéÂÇà¨éÒ...à»ç¹ªÔé¹æ...", "", bc_self;
	else if (.@r == 1)
		npctalk "ä´éâ»Ã´...ÍéÒ¡¡...", "", bc_self;
	else if (.@r == 2)
		npctalk "ä´éâ»Ã´...", "", bc_self;
	else if (.@r == 3)
		npctalk "¾ÃÐà¨éÒ...¨Ð¤ØéÁ¤ÃÍ§...à¨éÒ...¶éÒà¨éÒ...ÊÓ¹Ö¡¼Ô´...ã¹ºÒ»...·Õèà¨éÒ·ÓäÇé...", "", bc_self;
	else
		npctalk "...ÇéÒ¡¡¡¡...", "", bc_self;
	mes "[Victimized Soul's Mind]";
	mes "ÍÒÇØ¸àËÅèÒ¹Õé...¨ÐàµçÁä»´éÇÂ...¨ÔµÇÔ­­Ò³...áËè§¤ÇÒÁàÈÃéÒ...áÅÐ¤ÇÒÁá¤é¹...";
	mes "¶éÒà¨éÒ...¹ÓÁÑ¹...ÁÒ...¢éÒ¨Ðà»ÅÕèÂ¹...ÁÑ¹...à»ç¹ energy...pieces...";
	while(true) {
		next;
		if (checkweight(2677,5) == 0) {
			mes "[Victimized Soul's Mind]";
			mes "¡ÃÐà»ëÒà»é¢Í§¤Ø³ .. ";
			mes "àµçÁä»ËÁ´ ... ";
			close;
		}
		if (select( "Êè§ÁÍºÍÒÇØ¸.", "¨º¡ÒÃÊ¹·¹Ò." ) == 2) {
			mes "[Victimized Soul's Mind]";
			mes "...à¨éÒ¨Ð...¡ÅÑº...ÁÒËÒ¢éÒ...ÍÕ¡...";
			close;
		}
		mes "[Victimized Soul's Mind]";
		mes "àÅ×Í¡ª¹Ô´...ÍÒÇØ¸...·Õèà¨éÒ...µéÍ§¡ÒÃ...à»ÅÕèÂ¹ ?...";
		next;
		while(true) {
			switch( select( "¡ÅÑºä»·ÕèàÁ¹Ù¡èÍ¹Ë¹éÒ", "Katar", "Bow", "Axe, Mace, Book", "Wand", "Sword, Dagger", "Spear, Two-handed sword", "Musical instrument, Whip, Knuckle" ) ) {
			case 1:
				break;
			case 2:
				callsub S_Exchange,
					1284,	// Krishna
					1290,	// Agent_Katar
					1285,	// Chakram
					1291;	// Guillotine_Katar
				continue;
			case 3:
				callsub S_Exchange,
					18109,	// Catapult
					18110,	// Big_CrossBow
					1745,	// Falken_Blitz
					18103,	// Mystic_Bow
					18111;	// Creeper_Bow
				continue;
			case 4:
				callsub S_Exchange,
					1311,	// Vecer_Axe
					1392,	// Ygnus_Stale
					1393,	// End_Sektura
					16017,	// Bloody_Cross
					16010,	// Red_Ether_Bag
					2161,	// Geffenia_Book_Water
					1584,	// Chilly_Spell_Book
					16000,	// Erde
					16001;	// Red_Square_Bag
				continue;
			case 5:
				callsub S_Exchange,
					2005,	// Dea_Staff
					2004,	// Kronos
					1647,	// Croce_Staff
					1659,	// Recovery_Light
					1646,	// La'cryma_Stick
					1654;	// Mental_Stick
				continue;
			case 6:
				callsub S_Exchange,
					13431,	// Chrome_Sword
					13421,	// Ruber
					13061,	// Black_Wing
					13062,	// Ancient_Dagger
					13070,	// Scarletto_Nail
					13069,	// Aztoe_Nail
					13046,	// Krieg
					13047;	// Weihna
				continue;
			case 7:
				callsub S_Exchange,
					1433,	// Imperial_Spear
					1435,	// Cannon_Spear
					1490,	// Giant_Lance
					1196,	// Chrome_Twohand_Sword
					1189;	// Krasnaya
				continue;
			case 8:
				callsub S_Exchange,
					1930,	// Green_Whistle
					1984,	// Stem_Whip
					1985,	// Rosebine
					1830;	// Sura_Rampage
				continue;
			}
			break;
		}
	}
	end;

S_Exchange:
	.@size = getargcount();
	.@menu$ = "¡ÅÑºä»·ÕèàÁ¹Ù¡èÍ¹Ë¹éÒ:";
	for ( .@i = 0; .@i < .@size; .@i++ ) {
		if (countitem(getarg(.@i)) < 1)
			.@menu$ += "^999999äÁèÁÕ " + getitemname(getarg(.@i)) + ".^000000:";
		else
			.@menu$ += "à¨éÒÁÕ " + getitemname(getarg(.@i)) + ".:";
	}
	.@s = select(.@menu$) - 2;
	if (.@s == -1)
		return;
	mes "[Victimized Soul's Mind]";
	mes "à¨éÒ...ä´éàÅ×Í¡...ÍÒÇØ¸...«Öè§´ÙàËÁ×Í¹¨Ð...àµçÁä»´éÇÂ...¨ÔµÇÔ­­Ò³...¢éÒ¨Ð...¾ÂÒÂÒÁà»ÅÕèÂ¹ÁÑ¹...à»ç¹ Energy Fragments...à¨éÒ...àËç¹´éÇÂäËÁ ?";
	next;
	if (select( "äÁèàËç¹´éÇÂ.", "¨ÐàÍÒ Energy Fragments." ) == 2) {
		if (countitem(getarg(.@s)) < 1) {
			mes "[Victimized Soul's Mind]";
			mes "à¨éÒäÁè...ÁÕ...^006400" + getitemname(getarg(.@s)) + "^000000...";
			mes "à¨éÒÁÕ...¸ØÃÐÍÐäÃ¡Ñº¢éÒ...ÍÕ¡äËÁ ?...";
			next;
			return;
		}
		donpcevent strnpcinfo(0) + "::OnBar";
		sleep2 5000;
		specialeffect EF_BLACKBODY;
		specialeffect EF_GUMGANG4;
		specialeffect EF_DARKCASTING2;
		specialeffect EF_RG_COIN7;
		percentheal -50,-50;
		specialeffect2 EF_POISONSMOKE;
		specialeffect2 EF_NPC_BURNT;
		delitem getarg(.@s),1;
		.@r = rand(100);
		if (.@r < 70)
			.@amount = 1;
		else if (.@r < 90)
			.@amount = 2;
		else
			.@amount = 3;
		getitem 6820, .@amount;// Energy Fragment
		mes "[Victimized Soul's Mind]";
		mes "¢éÒä´éÊÃéÒ§...Energy...Fragment...¨Ò¡ ^006400" + getitemname(getarg(.@s)) + "^000000...";
		next;
		mes "- ¢éÒä´éÃÑº¤ÇÒÁàÊÕÂËÒÂÍÂèÒ§Ë¹Ñ¡ - - â´Â¤Å×è¹¾ÅÑ§§Ò¹ - - ä´é«ÖÁÊÙèÃèÒ§¡ÒÂ¢Í§¢éÒ. -";
		next;
	}
	mes "[Victimized Soul's Mind]";
	mes "à¨éÒÁÕ...¸ØÃÐÍÐäÃ¡Ñº¢éÒ...ÍÕ¡äËÁ ?...";
	next;
	return;

OnBar:
	progressbar_npc "000000",5;
	end;
}

lhz_dun_n,136,269,6	script	Sorrowful Soul's Mind#1	4_M_DEATH,{
	disable_items;
	.@r = rand(5);
	if (.@r == 0)
		npctalk "áÁè...ÁÑ¹à¨çº...", "", bc_self;
	else if (.@r == 1)
		npctalk "¾Ç¡à¨éÒ·Ø¡¤¹...ä»Å§¹Ã¡«Ð...", "", bc_self;
	else if (.@r == 2)
		npctalk "¢éÒäÁèà¢éÒã¨. ·ÓäÁ...¶Ö§à»ç¹¢éÒ ?...", "", bc_self;
	else if (.@r == 3)
		npctalk "ÍÑê¡...¢éÒäÁè...ÊÁ¤ÇÃä´éÃÑº...", "", bc_self;
	else
		npctalk "¾Ç¡à¨éÒ·Ø¡¤¹...¤×Í»ÔÈÒ¨...", "", bc_self;
	mes "[Sorrowful Soul's Mind]";
	mes "¨Ôµ...ÇÔ­­Ò³...ÍÑ¹ÁÒ¡ÁÒÂ...";
	mes "Í´Õµ...»Ñ¨¨ØºÑ¹...áÅÐ¡ÒÃá¡éá¤é¹...";
	next;
	if (.@r == 0)
		npctalk "ËÑÇã¨¢Í§¢éÒ...à¨çº»Ç´à¡Ô¹ä»...", "", bc_self;
	else if (.@r == 1)
		npctalk "¢éÒ...¨Ð...Êè§à¨éÒä»...", "", bc_self;
	else if (.@r == 2)
		npctalk "¢éÒ...äÁèÁÕàÇÅÒàËÅ×Í...·Õè¨ÐÍÂÙè·Õè¹ÕèµèÍáÅéÇ.", "", bc_self;
	else if (.@r == 3)
		npctalk "à¨éÒ¤Ô´ÇèÒ...à¨éÒ¨ÐÁÕªÕÇÔµÃÍ´...ËÅÑ§¨Ò¡·Õèà¨éÒ·ÓàÊÃç¨·Ø¡ÍÂèÒ§ÃÖ ?...", "", bc_self;
	else
		npctalk "¢éÒäÁèÃÙéàÃ×èÍ§...¢éÒ...äÁèÊÁ¤ÇÃä´éÃÑºÁÑ¹...", "", bc_self;
	mes "[Sorrowful Soul's Mind]";
	mes "à¨éÒ¤×Íã¤Ã ?...";
	mes "à¨éÒÊÒÁÒÃ¶...¹ÓàËÅèÒ¨ÔµÇÔ­­Ò³...·Õè·Ø¡¢ì·ÃÁÒ¹...¨Ò¡¤ÇÒÁàÈÃéÒÁÒä´éäËÁ ?...";
	next;
	if (.@r == 0)
		npctalk "¢éÒÍÂÒ¡...¡ÅÑº...ºéÒ¹...", "", bc_self;
	else if (.@r == 1)
		npctalk "¢éÒ¨Ð...ÊÒ»áªè§à¨éÒ...áÁéÇèÒ...¢éÒ¨ÐµÒÂä»áÅéÇ...", "", bc_self;
	else if (.@r == 2)
		npctalk "¢éÒäÁèÁÕ...ÍÐäÃ...", "", bc_self;
	else if (.@r == 3)
		npctalk "à¨éÒ¡ÓÅÑ§¤Ô´...ÍÐäÃÍÂÙè ?...", "", bc_self;
	else
		npctalk "à¨éÒ...äÁèà¤ÂÁÕ...áÁéáµè...¤ÃÍº¤ÃÑÇ ?...", "", bc_self;
	mes "[Sorrowful Soul's Mind]";
	mes "¶éÒà¨éÒ...ÊÒÁÒÃ¶...·ÓÁÑ¹ä´é...¢éÒÊÒÁÒÃ¶...ãËé...à¨éÒ...ÍÐäÃ...¡çä´é...·Õèà¨éÒµéÍ§¡ÒÃ...";
	next;
	setarray .@item_name$[0],
		getitemname(18971),	// Old_Rune_Circlet
		getitemname(18972),	// Old_Mitra
		getitemname(18973),	// Old_Driver_Band_R
		getitemname(18974),	// Old_Driver_Band_Y
		getitemname(18975),	// Old_Shadow_Handicraft
		getitemname(18976),	// Old_Minstrel_Song_Hat
		getitemname(18977),	// Old_Midas_Whisper
		getitemname(18978),	// Old_Magic_Stone_Hat
		getitemname(18979),	// Old_Blazing_Soul
		getitemname(18980),	// Old_Wind_Whisper
		getitemname(18981),	// Old_Dying_Swan
		getitemname(18984),	// Old_Camo_RabbitHood
		getitemname(18982),	// Old_Circlet_Of_Bone
		getitemname(18983),	// Old_Protect_Of_Crown
		getitemname(20749);	// Cloak of the Fallen Soldier[1]
	while(true) {
		if (checkweight(2677,5) == 0) {
			mes "[Sorrowful Soul's Mind]";
			mes "¡ÃÐà»ëÒà»é¢Í§¤Ø³ .. ";
			mes "àµçÁä»ËÁ´ ... ";
			close;
		}
		if (select( "Êè§ÁÍº soul.", "¨º¡ÒÃÊ¹·¹Ò." ) == 2) {
			mes "[Sorrowful Soul's Mind]";
			mes "...¢éÒ¨ÐÃÍ...à¨éÒ...¡ÅÑºÁÒ...ËÒ¢éÒÍÕ¡¤ÃÑé§...";
			close;
		}
		mes "[Sorrowful Soul's Mind]";
		mes "¶éÒà¨éÒÊè§ÁÍº...àËÅèÒ soul ÁÒ...¢éÒ¨ÐÊÃéÒ§¢Í§ºÒ§ÍÂèÒ§...·ÕèàµçÁä»´éÇÂ...¾ÅÑ§¾ÔàÈÉ..·Õè¼ÊÁà¢éÒ´éÇÂ¡Ñ¹...";
		mes "à¨éÒ...µéÍ§¡ÒÃ...ÍÐäÃ ?...";
		while(true) {
			next;
			switch( select( "¡ÅÑºä»·ÕèàÁ¹Ù¡èÍ¹Ë¹éÒ", .@item_name$[0], .@item_name$[1], .@item_name$[2], .@item_name$[3], .@item_name$[4], .@item_name$[5], .@item_name$[6], .@item_name$[7], .@item_name$[8], .@item_name$[9], .@item_name$[10], .@item_name$[11], .@item_name$[12], .@item_name$[13], .@item_name$[14] + "[1]" ) ) {
			case 1:
				break;
			case 2:
				mes "- " + .@item_name$[0] + " -";
				mes "^006400äÍà·çÁ¹ÕéäÁèÊÒÁÒÃ¶áÅ¡à»ÅÕèÂ¹¡ÑºáÍ¤à¤éÒ·ìÍ×è¹ä´é.^000000";
				mes "^006400All State + 1, MDEF+ 5^000000";
				mes "^006400à¾ÔèÁ ATK + 4 µèÍ 1 àÅàÇÅµÕºÇ¡^000000";
				mes "^006400à¾ÔèÁ ASPD + 1 µèÍ 5 àÅàÇÅµÕºÇ¡^000000";
				mes "^006400à¾ÔèÁ MHP, MSP ¢Öé¹ 1% ·Ø¡ 2 àÅàÇÅµÕºÇ¡^000000";
				mes "^006400à¾ÔèÁ ¤ÇÒÁáÃ§ Ignition Break ¢Öé¹ 20%^000000";
				mes "^006400µèÍ 2 àÅàÇÅµÕºÇ¡^000000";
				mes "^006400à¾ÔèÁ ¤ÇÒÁáÃ§ Hundred Spear ¢Öé¹ 15%^000000";
				mes "^006400µèÍ 2 àÅàÇÅµÕºÇ¡^000000";
				mes "^006400»ÃÐàÀ·: ËÁÇ¡ »éÍ§¡Ñ¹: 10^000000";
				mes "^006400µÓáË¹è§: ÊèÇ¹º¹ ¹éÓË¹Ñ¡: 10^000000";
				mes "^006400ªèÍ§ÇèÒ§: 1^000000";
				mes "^006400µéÍ§¡ÒÃàÅàÇÅ: 170 ÍÒªÕ¾: Rune Knight^000000";
				callsub S_Make,
					18971,	// Old_Rune_Circlet
					19961,	// C_Rune_Circlet
					6814;	// Swordman_Soul
				continue;
			case 3:
				mes "- " + .@item_name$[1] + " -";
				mes "^006400äÍà·çÁ¹ÕéäÁèÊÒÁÒÃ¶áÅ¡à»ÅÕèÂ¹¡ÑºáÍ¤à¤éÒ·ìÍ×è¹ä´é.^000000";
				mes "^006400All State + 1, MDEF+ 5^000000";
				mes "^006400à¾ÔèÁ MATK + 2, ATK + 4, Heal Amount + 2% µèÍ 1 àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400à¾ÔèÁ MHP, MSP ¢Öé¹ 1% ·Ø¡ 2 àÅàÇÅµÕºÇ¡^000000";
				mes "^006400à¾ÔèÁ ¤ÇÒÁáÃ§ Judex ¢Öé¹ 20% µèÍ 2 àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400à¾ÔèÁ ¤ÇÒÁáÃ§ Magnus Exorcismus ¢Öé¹ 10% µèÍ 2 àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400»ÃÐàÀ·: ËÁÇ¡ »éÍ§¡Ñ¹: 10^000000";
				mes "^006400µÓáË¹è§: ÊèÇ¹º¹ ¹éÓË¹Ñ¡: 10^000000";
				mes "^006400ªèÍ§ÇèÒ§: 1^000000";
				mes "^006400µéÍ§¡ÒÃàÅàÇÅ: 170 ÍÒªÕ¾: Archbishop^000000";
				callsub S_Make,
					18972,	// Old_Mitra
					19962,	// C_Mitra
					6819;	// Acolyte_Soul
				continue;
			case 4:
				mes "- " + .@item_name$[2] + " -";
				mes "^006400äÍà·çÁ¹ÕéäÁèÊÒÁÒÃ¶áÅ¡à»ÅÕèÂ¹¡ÑºáÍ¤à¤éÒ·ìÍ×è¹ä´é.^000000";
				mes "^006400All State + 1^000000";
				mes "^006400à¾ÔèÁ ATK + 4 µèÍ 1 àÅàÇÅµÕºÇ¡^000000";
				mes "^006400à¾ÔèÁ ASPD + 1 µèÍ 5 àÅàÇÅµÕºÇ¡^000000";
				mes "^006400à¾ÔèÁ MHP, MSP ¢Öé¹ 1% ·Ø¡ 2 àÅàÇÅµÕºÇ¡^000000";
				mes "^006400à¾ÔèÁ ¤ÇÒÁáÃ§ Power Swing ¢Öé¹ 20% µèÍ 2 àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400à¾ÔèÁ ¤ÇÒÁáÃ§ Axe Tornado ¢Öé¹ 20% µèÍ 2 àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400»ÃÐàÀ·: ËÁÇ¡ »éÍ§¡Ñ¹: 10^000000";
				mes "^006400µÓáË¹è§: ÊèÇ¹º¹ ¹éÓË¹Ñ¡: 10^000000";
				mes "^006400ªèÍ§ÇèÒ§: 1^000000";
				mes "^006400µéÍ§¡ÒÃàÅàÇÅ: 170 ÍÒªÕ¾: Mechanic^000000";
				callsub S_Make,
					18973,	// Old_Driver_Band_R
					19963,	// C_Driver_Band_R
					6815;	// Merchant_Soul
				continue;
			case 5:
				mes "- " + .@item_name$[3] + " -";
				mes "^006400äÍà·çÁ¹ÕéäÁèÊÒÁÒÃ¶áÅ¡à»ÅÕèÂ¹¡ÑºáÍ¤à¤éÒ·ìÍ×è¹ä´é.^000000";
				mes "^006400All State + 1^000000";
				mes "^006400à¾ÔèÁ ATK + 4 µèÍ 1 àÅàÇÅµÕºÇ¡^000000";
				mes "^006400à¾ÔèÁ ASPD + 1 µèÍ 5 àÅàÇÅµÕºÇ¡^000000";
				mes "^006400à¾ÔèÁ MHP, MSP ¢Öé¹ 1% ·Ø¡ 2 àÅàÇÅµÕºÇ¡^000000";
				mes "^006400à¾ÔèÁ ¤ÇÒÁáÃ§ Arm Cannon ¢Öé¹ 5% µèÍ 2 àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400Å´ ¤ÙÅ´ÒÇ¹ì Suicidal Destruction Å§ 10 ÇÔ¹Ò·Õ µèÍ 4 àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400»ÃÐàÀ·: ËÁÇ¡ »éÍ§¡Ñ¹: 10^000000";
				mes "^006400µÓáË¹è§: ÊèÇ¹º¹ ¹éÓË¹Ñ¡: 10^000000";
				mes "^006400ªèÍ§ÇèÒ§: 1^000000";
				mes "^006400µéÍ§¡ÒÃàÅàÇÅ: 170 ÍÒªÕ¾: Mechanic^000000";
				callsub S_Make,
					18974,	// Old_Driver_Band_Y
					19964,	// C_Driver_Band_Y
					6815;	// Merchant_Soul
				continue;
			case 6:
				mes "- " + .@item_name$[4] + " -";
				mes "^006400äÍà·çÁ¹ÕéäÁèÊÒÁÒÃ¶áÅ¡à»ÅÕèÂ¹¡ÑºáÍ¤à¤éÒ·ìÍ×è¹ä´é.^000000";
				mes "^006400All State + 1^000000";
				mes "^006400à¾ÔèÁ ATK + 4, MATK + 4 ·Ø¡ àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400à¾ÔèÁ MHP, MSP ¢Öé¹ 1% ·Ø¡ 2 àÅàÇÅµÕºÇ¡^000000";
				mes "^006400à¾ÔèÁ ¤ÇÒÁáÃ§ Triangle Shot ¢Öé¹ 25% µèÍ 2 àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400Å´ ¤ÙÅ´ÒÇ¹ì Masquerade-unlock key, Enervation Å§ 1 ÇÔ¹Ò·Õ àÁ×èÍàÅàÇÅµÕºÇ¡¶Ö§ 6.^000000";
				mes "^006400Å´ ¤ÙÅ´ÒÇ¹ì Masquerade-Laziness, Weakness Å§ 1 ÇÔ¹Ò·Õ àÁ×èÍàÅàÇÅµÕºÇ¡¶Ö§ 8.^000000";
				mes "^006400Å´ ¤ÙÅ´ÒÇ¹ì Masquerade-Ignorance, Gloomy Å§ 1 ÇÔ¹Ò·Õ àÁ×èÍàÅàÇÅµÕºÇ¡¶Ö§ 10.^000000";
				mes "^006400»ÃÐàÀ·: ËÁÇ¡ »éÍ§¡Ñ¹: 10^000000";
				mes "^006400µÓáË¹è§: ÊèÇ¹º¹ ¹éÓË¹Ñ¡: 10^000000";
				mes "^006400ªèÍ§ÇèÒ§: 1^000000";
				mes "^006400µéÍ§¡ÒÃàÅàÇÅ: 170 ÍÒªÕ¾: Shadow_Chaser^000000";
				callsub S_Make,
					18975,	// Old_Shadow_Handicraft
					19965,	// C_Shadow_Handicraft
					6816;	// Thief_Soul
				continue;
			case 7:
				mes "- " + .@item_name$[5] + " -";
				mes "^006400äÍà·çÁ¹ÕéäÁèÊÒÁÒÃ¶áÅ¡à»ÅÕèÂ¹¡ÑºáÍ¤à¤éÒ·ìÍ×è¹ä´é.^000000";
				mes "^006400All State + 1^000000";
				mes "^006400à¾ÔèÁ ¤ÇÒÁáÃ§ ranged physical ¢Öé¹ 1% ·Ø¡ àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400à¾ÔèÁ MHP, MSP ¢Öé¹ 1% ·Ø¡ 2 àÅàÇÅµÕºÇ¡^000000";
				mes "^006400à¾ÔèÁ ¤ÇÒÁáÃ§ Arrow Vulcan ¢Öé¹ 20% µèÍ 2 àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400à¾ÔèÁ ¤ÇÒÁáÃ§ Severe Rainstorm ¢Öé¹ 5% µèÍ 2 àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400»ÃÐàÀ·: ËÁÇ¡ »éÍ§¡Ñ¹: 10^000000";
				mes "^006400µÓáË¹è§: ÊèÇ¹º¹ ¹éÓË¹Ñ¡: 10^000000";
				mes "^006400ªèÍ§ÇèÒ§: 1^000000";
				mes "^006400µéÍ§¡ÒÃàÅàÇÅ: 170 ÍÒªÕ¾: Minstrel^000000";
				callsub S_Make,
					18976,	// Old_Minstrel_Song_Hat
					19966,	// C_Minstrel_Song_Hat
					6818;	// Archer_Soul
				continue;
			case 8:
				mes "- " + .@item_name$[6] + " -";
				mes "^006400äÍà·çÁ¹ÕéäÁèÊÒÁÒÃ¶áÅ¡à»ÅÕèÂ¹¡ÑºáÍ¤à¤éÒ·ìÍ×è¹ä´é.^000000";
				mes "^006400All State + 1^000000";
				mes "^006400à¾ÔèÁ ATK + 4 µèÍ 1 àÅàÇÅµÕºÇ¡^000000";
				mes "^006400à¾ÔèÁ ranged physical ¢Öé¹ 1% µèÍ 2 àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400à¾ÔèÁ MHP, MSP ¢Öé¹ 1% ·Ø¡ 2 àÅàÇÅµÕºÇ¡^000000";
				mes "^006400à¾ÔèÁ ¤ÇÒÁáÃ§ Cart Cannon ¢Öé¹ 15% µèÍ 2 àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400»ÃÐàÀ·: ËÁÇ¡ »éÍ§¡Ñ¹: 10^000000";
				mes "^006400µÓáË¹è§: ÊèÇ¹º¹ ¹éÓË¹Ñ¡: 10^000000";
				mes "^006400ªèÍ§ÇèÒ§: 1^000000";
				mes "^006400µéÍ§¡ÒÃàÅàÇÅ: 170 ÍÒªÕ¾: Generic^000000";
				callsub S_Make,
					18977,	// Old_Midas_Whisper
					19967,	// C_Midas_Whisper
					6815;	// Merchant_Soul
				continue;
			case 9:
				mes "- " + .@item_name$[7] + " -";
				mes "^006400äÍà·çÁ¹ÕéäÁèÊÒÁÒÃ¶áÅ¡à»ÅÕèÂ¹¡ÑºáÍ¤à¤éÒ·ìÍ×è¹ä´é.^000000";
				mes "^006400All State + 1 MDEF+ 5^000000";
				mes "^006400à¾ÔèÁ SP regen ¢Öé¹ 20%.^000000";
				mes "^006400à¾ÔèÁ MATK + 1% ·Ø¡ àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400à¾ÔèÁ MHP, MSP ¢Öé¹ 1% ·Ø¡ 2 àÅàÇÅµÕºÇ¡^000000";
				mes "^006400à¾ÔèÁ ¤ÇÒÁáÃ§ Soul Expansion ¢Öé¹ 5% µèÍ 2 àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400Å´ ¤ÙÅ´ÒÇ¹ì Crimson Rock Å§ 1 ÇÔ¹Ò·Õ.^000000";
				mes "^006400Å´ ¤ÙÅ´ÒÇ¹ì Crimson Rock Å§ 0.1 ·Ø¡ àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400»ÃÐàÀ·: ËÁÇ¡ »éÍ§¡Ñ¹: 10^000000";
				mes "^006400µÓáË¹è§: ÊèÇ¹º¹ ¹éÓË¹Ñ¡: 10^000000";
				mes "^006400ªèÍ§ÇèÒ§: 1^000000";
				mes "^006400µéÍ§¡ÒÃàÅàÇÅ: 170 ÍÒªÕ¾: Warlock^000000";
				callsub S_Make,
					18978,	// Old_Magic_Stone_Hat
					19968,	// C_Magic_Stone_Hat
					6817;	// Mage_Soul
				continue;
			case 10:
				mes "- " + .@item_name$[8] + " -";
				mes "^006400äÍà·çÁ¹ÕéäÁèÊÒÁÒÃ¶áÅ¡à»ÅÕèÂ¹¡ÑºáÍ¤à¤éÒ·ìÍ×è¹ä´é.^000000";
				mes "^006400All State + 1^000000";
				mes "^006400à¾ÔèÁ ATK + 4, CRI + 2 ·Ø¡ àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400à¾ÔèÁ MHP, MSP ¢Öé¹ 1% ·Ø¡ 2 àÅàÇÅµÕºÇ¡^000000";
				mes "^006400à¾ÔèÁ ¤ÇÒÁáÃ§ Rampage Blaster ¢Öé¹ 15% µèÍ 2 àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400à¾ÔèÁ ¤ÇÒÁáÃ§ Lightning Shot ¢Öé¹ 20% µèÍ 2 àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400»ÃÐàÀ·: ËÁÇ¡ »éÍ§¡Ñ¹: 10^000000";
				mes "^006400µÓáË¹è§: ÊèÇ¹º¹ ¹éÓË¹Ñ¡: 10^000000";
				mes "^006400ªèÍ§ÇèÒ§: 1^000000";
				mes "^006400µéÍ§¡ÒÃàÅàÇÅ: 170 ÍÒªÕ¾: Sura^000000";
				callsub S_Make,
					18979,	// Old_Blazing_Soul
					19969,	// C_Blazing_Soul
					6819;	// Acolyte_Soul
				continue;
			case 11:
				mes "- " + .@item_name$[9] + " -";
				mes "^006400äÍà·çÁ¹ÕéäÁèÊÒÁÒÃ¶áÅ¡à»ÅÕèÂ¹¡ÑºáÍ¤à¤éÒ·ìÍ×è¹ä´é.^000000";
				mes "^006400All State + 1 MDEF+ 5.^000000";
				mes "^006400à¾ÔèÁ MATK + 1%, ATK + 4 ·Ø¡ àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400à¾ÔèÁ MHP, MSP ¢Öé¹ 1% ·Ø¡ 2 àÅàÇÅµÕºÇ¡^000000";
				mes "^006400à¾ÔèÁ ¤ÇÒÁáÃ§ Poison Burst ¢Öé¹ 15% µèÍ 2 àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400à¾ÔèÁ ¤ÇÒÁáÃ§ Varetyr Spear ¢Öé¹ 20% µèÍ 2 àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400»ÃÐàÀ·: ËÁÇ¡ »éÍ§¡Ñ¹: 10^000000";
				mes "^006400µÓáË¹è§: ÊèÇ¹º¹ ¹éÓË¹Ñ¡: 10^000000";
				mes "^006400ªèÍ§ÇèÒ§: 1^000000";
				mes "^006400µéÍ§¡ÒÃàÅàÇÅ: 170 ÍÒªÕ¾: Sorcerer^000000";
				callsub S_Make,
					18980,	// Old_Wind_Whisper
					19970,	// C_Wind_Whisper
					6817;	// Mage_Soul
				continue;
			case 12:
				mes "- " + .@item_name$[10] + " -";
				mes "^006400äÍà·çÁ¹ÕéäÁèÊÒÁÒÃ¶áÅ¡à»ÅÕèÂ¹¡ÑºáÍ¤à¤éÒ·ìÍ×è¹ä´é.^000000";
				mes "^006400All State + 1^000000";
				mes "^006400à¾ÔèÁ ranged physical ¢Öé¹ 1% ·Ø¡ àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400à¾ÔèÁ MHP, MSP ¢Öé¹ 1% ·Ø¡ 2 àÅàÇÅµÕºÇ¡^000000";
				mes "^006400à¾ÔèÁ ¤ÇÒÁáÃ§ Arrow Vulcan ¢Öé¹ 20% µèÍ 2 àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400à¾ÔèÁ ¤ÇÒÁáÃ§ Severe Rainstorm ¢Öé¹ 5% µèÍ 2 àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400»ÃÐàÀ·: ËÁÇ¡ »éÍ§¡Ñ¹: 10^000000";
				mes "^006400µÓáË¹è§: ÊèÇ¹º¹ ¹éÓË¹Ñ¡: 10^000000";
				mes "^006400ªèÍ§ÇèÒ§: 1^000000";
				mes "^006400µéÍ§¡ÒÃàÅàÇÅ: 170 ÍÒªÕ¾: Wanderer^000000";
				callsub S_Make,
					18981,	// Old_Dying_Swan
					19971,	// C_Dying_Swan
					6818;	// Archer_Soul
				continue;
			case 13:
				mes "- " + .@item_name$[11] + " -";
				mes "^006400äÍà·çÁ¹ÕéäÁèÊÒÁÒÃ¶áÅ¡à»ÅÕèÂ¹¡ÑºáÍ¤à¤éÒ·ìÍ×è¹ä´é.^000000";
				mes "^006400All State + 1^000000";
				mes "^006400à¾ÔèÁ ranged physical ¢Öé¹ 1% ·Ø¡ àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400Complete evasion +1 µèÍ 3 àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400à¾ÔèÁ MHP, MSP ¢Öé¹ 1% ·Ø¡ 2 àÅàÇÅµÕºÇ¡^000000";
				mes "^006400à¾ÔèÁ ¤ÇÒÁáÃ§ Cluster Bomb ¢Öé¹ 15% µèÍ 2 àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400à¾ÔèÁ ¤ÇÒÁáÃ§ Warg Strike ¢Öé¹ 10% µèÍ 2 àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400»ÃÐàÀ·: ËÁÇ¡ »éÍ§¡Ñ¹: 10^000000";
				mes "^006400µÓáË¹è§: ÊèÇ¹º¹ ¹éÓË¹Ñ¡: 10^000000";
				mes "^006400ªèÍ§ÇèÒ§: 1^000000";
				mes "^006400µéÍ§¡ÒÃàÅàÇÅ: 170 ÍÒªÕ¾: Ranger^000000";
				callsub S_Make,
					18984,	// Old_Camo_RabbitHood
					19974,	// C_Camouflage_RabbitHood
					6818;	// Archer_Soul
				continue;
			case 14:
				mes "- " + .@item_name$[12] + " -";
				mes "^006400äÍà·çÁ¹ÕéäÁèÊÒÁÒÃ¶áÅ¡à»ÅÕèÂ¹¡ÑºáÍ¤à¤éÒ·ìÍ×è¹ä´é.^000000";
				mes "^006400All State + 1^000000";
				mes "^006400à¾ÔèÁ ¤ÇÒÁáÃ§ critical ¢Öé¹ 1% áÅÐ attack speed ·Ø¡ àÅàÇÅµÕºÇ¡ (Å´ attack delay 1%)^000000";
				mes "^006400à¾ÔèÁ MHP, MSP ¢Öé¹ 1% ·Ø¡ 2 àÅàÇÅµÕºÇ¡^000000";
				mes "^006400à¾ÔèÁ ¤ÇÒÁáÃ§ Cross Impact ¢Öé¹ 10% µèÍ 2 àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400à¾ÔèÁ ¤ÇÒÁáÃ§ Cross Reaper Slash ¢Öé¹ 20% µèÍ 2 àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400»ÃÐàÀ·: ËÁÇ¡ »éÍ§¡Ñ¹: 10^000000";
				mes "^006400µÓáË¹è§: ÊèÇ¹º¹ ¹éÓË¹Ñ¡: 10^000000";
				mes "^006400ªèÍ§ÇèÒ§: 1^000000";
				mes "^006400µéÍ§¡ÒÃàÅàÇÅ: 170 ÍÒªÕ¾: Guillotine_Cross^000000";
				callsub S_Make,
					18982,	// Old_Circlet_Of_Bone
					19973,	// C_Circlet_Of_Bone
					6816;	// Thief_Soul
				continue;
			case 15:
				mes "- " + .@item_name$[13] + " -";
				mes "^006400äÍà·çÁ¹ÕéäÁèÊÒÁÒÃ¶áÅ¡à»ÅÕèÂ¹¡ÑºáÍ¤à¤éÒ·ìÍ×è¹ä´é.^000000";
				mes "^006400All State + 1 MDEF+ 5.^000000";
				mes "^006400à¾ÔèÁ ATK + 4 µèÍ 1 àÅàÇÅµÕºÇ¡^000000";
				mes "^006400à¾ÔèÁ ASPD + 1 µèÍ 5 àÅàÇÅµÕºÇ¡^000000";
				mes "^006400à¾ÔèÁ MHP, MSP ¢Öé¹ 1% ·Ø¡ 2 àÅàÇÅµÕºÇ¡^000000";
				mes "^006400à¾ÔèÁ ¤ÇÒÁáÃ§ Cannon Spear ¢Öé¹ 20% µèÍ 2 àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400à¾ÔèÁ ¤ÇÒÁáÃ§ Over Brand ¢Öé¹ 5% µèÍ 2 àÅàÇÅµÕºÇ¡.^000000";
				mes "^006400»ÃÐàÀ·: ËÁÇ¡ »éÍ§¡Ñ¹: 10^000000";
				mes "^006400µÓáË¹è§: ÊèÇ¹º¹ ¹éÓË¹Ñ¡: 10^000000";
				mes "^006400ªèÍ§ÇèÒ§: 1^000000";
				mes "^006400µéÍ§¡ÒÃàÅàÇÅ: 170 ÍÒªÕ¾: Royal Guard^000000";
				callsub S_Make,
					18983,	// Old_Protect_Of_Crown
					19972,	// C_Protect_Of_Crown
					6814;	// Swordman_Soul
				continue;
			case 16:
				mes "- " + .@item_name$[14] + "[1] -";
				mes "^006400¼éÒ¤ÅØÁã¹µÓ¹Ò¹·Õèà¤ÂÁÕ¤¹ÊÇÁãÊè^000000 ^006400ã¹¡ÒÃµèÍÊÙéÍÂèÒ§¡ÅéÒËÒ­áÅÐ¶Ù¡¦èÒµÒÂã¹Ê¹ÒÁÃº.";
				mes "à¾ÔèÁ MHP, MSP ¢Öé¹ 1% µèÍ 2 àÅàÇÅµÕºÇ¡";
				mes "ATK + 10 àÁ×èÍµÑÇÅÐ¤ÃÁÕ¤èÒ STR ¨ÃÔ§ ¶Ö§ 90.";
				mes "(à¾ÔèÁ ATK + 2 ·Ø¡ àÅàÇÅµÕºÇ¡)";
				mes "MATK + 20 àÁ×èÍµÑÇÅÐ¤ÃÁÕ¤èÒ INT ¨ÃÔ§ ¶Ö§ 90.";
				mes "(à¾ÔèÁ MATK + 3 ·Ø¡ àÅàÇÅµÕºÇ¡)";
				mes "àÁ×èÍµÑÇÅÐ¤ÃÁÕ¤èÒ VIT ¨ÃÔ§ ¶Ö§ 90";
				mes "3% ¤èÒ¤ÇÒÁµéÒ¹·Ò¹µèÍ¡ÒÃâ¨ÁµÕ»¡µÔ";
				mes "(à¾ÔèÁ 3% àÁ×èÍàÅàÇÅµÕºÇ¡¶Ö§ 8,";
				mes "à¾ÔèÁ 4% àÁ×èÍàÅàÇÅµÕºÇ¡¶Ö§ 10)";
				mes "àÁ×èÍµÑÇÅÐ¤ÃÁÕ¤èÒ AGI ¨ÃÔ§ ¶Ö§ 90";
				mes "à¾ÔèÁ attack speed (3% attack delay reduction)";
				mes "(Attack delay Å´Å§ 1% µèÍ 2 àÅàÇÅµÕºÇ¡)";
				mes "(à¾ÔèÁ ASPD + 1 àÁ×èÍàÅàÇÅµÕºÇ¡¶Ö§ 10.)";
				mes "àÁ×èÍµÑÇÅÐ¤ÃÁÕ¤èÒ DEX ¨ÃÔ§ ¶Ö§ 90";
				mes "à¾ÔèÁ ranged attack power ¢Öé¹ 3%";
				mes "(à¾ÔèÁ 1% µèÍ 2 àÅàÇÅµÕºÇ¡)";
				mes "àÁ×èÍµÑÇÅÐ¤ÃÁÕ¤èÒ LUK ¨ÃÔ§ ¶Ö§ 90";
				mes "à¾ÔèÁ ¤ÇÒÁáÃ§ critical ¢Öé¹ 5%.";
				mes "(à¾ÔèÁ 1% ·Ø¡ àÅàÇÅµÕºÇ¡)";
				mes "»ÃÐàÀ·: ¼éÒ¤ÅØÁ »éÍ§¡Ñ¹: 30";
				mes "¹éÓË¹Ñ¡: 60";
				mes "ªèÍ§ÇèÒ§: 1";
				mes "µéÍ§¡ÒÃàÅàÇÅ: 170 ÍÒªÕ¾: ·Ñé§ËÁ´^000000";
				callsub S_Make,
					20749,	// Manteau_Of_Fallen_
					20748,	// Manteau_Of_Fallen
					6471,	// Goast_Chill
					true;
				continue;
			}
			break;
		}
	}

S_Make:
	.@reward_id = getarg(0);
	.@equipment_req = getarg(1);
	.@item_misc_req = getarg(2);
	if (getarg(3,0)) {
		setarray .@string$[0], "chill", "cloak";
		setarray .@material[0],20,100;	// chill, energy
	}
	else {
		setarray .@string$[0], "soul", "hat";
		setarray .@material[0],1,20;	// soul, energy
	}
	next;
	mes "[Sorrowful Soul's Mind]";
	mes "à¾×èÍ·Õè¨Ð·Ó...^006400" + getitemname(.@reward_id) + "^000000...";
	mes "¹Ó...àËÅèÒ " + .@string$[0] + ", " + .@string$[1] + "...·ÕèÇ¹àÇÕÂ¹...ÍÂÙèã¹·ÕèæàµçÁä»´éÇÂ...¾ÅÑ§§Ò¹Á×´ÁÒ...";
	next;
	mes "[Sorrowful Soul's Mind]";
	mes "¢éÒµéÍ§¡ÒÃ 1 " + getitemname(.@equipment_req) + ", " + .@material[0] + " " + getitemname(.@item_misc_req) + "..." + .@material[1] + " " + getitemname(6820) + "..";
	mes "¶éÒà¡çºÊÐÊÁ " + getitemname(6820) + " áÅÐ " + .@string$[0] + "ä´é 5 à·èÒ...à¨éÒ...¨ÐäÁèÅéÁàËÅÇ...";
	mes "à¨éÒ...¨Ð·Ó...áººäË¹ ?";
	next;
	switch( select( "¡ÅÑºä»·ÕèàÁ¹Ù¡èÍ¹Ë¹éÒ", "ãªé " + .@material[1] + " energies, " + .@material[0] + " " + .@string$[0], "ãªé " + (.@material[1] * 5) + " energies, " + (.@material[0] * 5) + " " + .@string$[0] + "s" ) ) {
	case 1:
		mes "[Sorrowful Soul's Mind]";
		mes "¢éÒËÇÑ§ÇèÒ...à¨éÒÊÒÁÒÃ¶...´Ù...ÊÔè§Í×è¹ æ...ä´éàªè¹¡Ñ¹...";
		return;
	case 2:
		.@rate = 1;
		break;
	case 3:
		.@rate = 5;
		break;
	}
	if (countitem(.@equipment_req) < 1 || countitem(.@item_misc_req) < (.@material[0] * .@rate) || countitem(6820) < (.@material[1] * .@rate)) {
		mes "[Sorrowful Soul's Mind]";
		mes "à¨éÒäÁè...ÁÕ...ÇÑµ¶Ø´Ôº¾Í...·Õè¨Ð·Ó...^006400" + getitemname(.@reward_id) + "^000000...";
		return;
	}
	progressbar "000000",5;
	percentheal -50,-50;
	specialeffect2 EF_POISONSMOKE;
	specialeffect2 EF_NPC_BURNT;
	delitem .@equipment_req, 1;
	delitem .@item_misc_req, (.@material[0] * .@rate);
	delitem 6820, (.@material[1] * .@rate);// Energy Fragment

	if ((20*.@rate) > rand(100)) {
		specialeffect EF_BLACKBODY;
		specialeffect EF_GUMGANG4;
		specialeffect EF_DARKCASTING2;
		specialeffect EF_RG_COIN7;
		mes "[Sorrowful Soul's Mind]";
		mes "àÍÒä»...^006400" + getitemname(.@reward_id) + "^000000...";
		getitem .@reward_id,1;
	}
	else {
		specialeffect EF_POISONSMOKE;
		specialeffect EF_GUMGANG4;
		mes "[Sorrowful Soul's Mind]";
		mes "^006400" + getitemname(.@reward_id) + "^000000... ÅéÁàËÅÇ...";
	}
	next;
	mes "- ¢éÒä´éÃÑº¤ÇÒÁàÊÕÂËÒÂÍÂèÒ§Ë¹Ñ¡ - - â´Â¤Å×è¹¾ÅÑ§§Ò¹ - - ä´é«ÖÁÊÙèÃèÒ§¡ÒÂ¢Í§¢éÒ. -";
	next;
	mes "[Sorrowful Soul's Mind]";
	mes "ÁÕÍÐäÃ...·Õè¢éÒ...¾Í¨ÐªèÇÂ...à¨éÒä´éäËÁ ?...";
	return;
}

// Exchange npcs - safe map (no mobs)
lhz_d_n2,53,49,4	duplicate(Silent Mind#JCv2)	Silent Mind#JCv2C	4_CENERE
lhz_d_n2,42,49,2	duplicate(Wandering Mind#JCv2)	Wandering Mind#JCv2C	4_CENERE
lhz_d_n2,51,53,4	duplicate(Victimized Soul's Mind#1)	Victimized Soul's Mind#1C	4_M_DEATH2
lhz_d_n2,44,53,6	duplicate(Sorrowful Soul's Mind#1)	Sorrowful Soul's Mind#1C	4_M_DEATH

// Safe map - Exit
lhz_d_n2,34,45,3	script	#lhzdw	1_SHADOW_NPC,{
	mes "[Bastets]";
	mes "à¨éÒÊÒÁÒÃ¶àËç¹·Ò§ÍÍ¡ä´é.";
	next;
	if (select( "¡ÅÑºä»·Õè Lighthalzen.", "ÂÑ§äÁè¡ÅÑº." ) == 1)
		warp "lighthalzen",310,228;
	end;
}

// Heal
lhz_dun_n,167,259,2	script	A Questionable Device#l	4_SYSTEM_BOX,3,3,{
	if (isbegin_quest(14683) == 1) {
		mes "[System Message]";
		mes "â»Ãâµ¤ÍÅ ©Ø¡à©Ô¹ à»Ô´ãªé§Ò¹. ¼ÙéàÅè¹ÊÒÁÒÃ¶à´Ô¹à¤Ã×èÍ§ RT-223 ä´é.";
		next;
		if (select( "äÁèà´Ô¹à¤Ã×èÍ§.", "à´Ô¹à¤Ã×èÍ§." ) == 2) {
			mes "[System Message]";
			mes "·Ø¡¤¹¤ÇÃ»¯ÔºÑµÔµÒÁ¡®©Ø¡à©Ô¹.";
			close;
		}
		specialeffect EF_MAPPILLAR;
		mes "[System Message]";
		mes "¼ÙéàÅè¹¡ÓÅÑ§à´Ô¹à¤Ã×èÍ§ RT-223. âËÁ´Êáµ¹´ìºÒÂ¨Ðà»Ô´ãªé§Ò¹ËÅÑ§¨Ò¡¢Ñé¹µÍ¹¹Õé.";
		specialeffect2 EF_BABY;
		percentheal 100,100;
		completequest 14683;// Mysterious Device
		close;
	}
	end;

OnTouch:
	npctalk "·Ø¡¤¹¤ÇÃ»¯ÔºÑµÔµÒÁ¡®©Ø¡à©Ô¹.", "", bc_self;
	end;

OnInit:
	questinfo( QTYPE_QUEST, QMARK_YELLOW, "isbegin_quest(14683) == 1" );
	end;
}

// Misc
lhz_dun_n,75,121,0	script	#Alphoccio_Basil_A1	HIDDEN_WARP_NPC,3,3,{
	end;
OnTouch:
	specialeffect EF_BAT2;
	disablenpc strnpcinfo(0);
	initnpctimer;
	end;
OnTimer1000:
	.@npc_name$ = strnpcinfo(0);
	if (.@npc_name$ == "#Alphoccio_Basil_A1") {
		.@talker_name$ = "#lhz_dun_talk_A23"; 
		switch (rand(5)) {
			case 0:  .@msg$ = "à»ç¹¤ÇÒÁ¼Ô´¾ÅÒ´¢Í§©Ñ¹·Õè¤Ô´ÇèÒ¹Õè¨Ðà»ç¹á¤è¡ÒÃà´Ô¹·Ò§..."; break;
			case 1:  .@msg$ = "ÎÐ...áÅéÇä§..¡ç¿Ñ§àÁÕÂ..."; break;
			case 2:  .@msg$ = "¾Ç¡à¢Ò·Ñé§ËÁ´·Õè¹Õèà»ç¹ÍÐäÃ?..·ÓäÁµéÍ§µÒáºº¹Õé.."; break;
			case 3:  .@msg$ = "©Ñ¹ä´éÂÔ¹àÊÕÂ§à¾Å§áÅÐàÊÕÂ§à¾Å§..ÎèÒÎèÒÎèÒ..."; break;
			default:  .@msg$ = "©Ñ¹ÍÂÙè·ÕèäË¹..ÁÕ·Ò§ÍÍ¡ËÃ×ÍäÁè.."; break;
		}
	}
	else if (.@npc_name$ == "#Alphoccio_Basil_A2") {
		.@talker_name$ = "#lhz_dun_talk_A24";
		switch (rand(5)) {
			case 0:  .@msg$ = "©Ñ¹¤Ô´ÇèÒàÃÒ¨Ð·Óà¾Å§áÅÐà´Ô¹·Ò§ÃÍºâÅ¡ä´éµÅÍ´ä»..."; break;
			case 1:  .@msg$ = "äÁèÊÓ¤Ñ­ÇèÒàÃÒ¨ÐÍÂÙè·ÕèäË¹ã¹¢³Ð·Õè¤Ø³ÍÂÙèã¡Åé©Ñ¹..."; break;
			case 2:  .@msg$ = "Trentini...¤Ø³ÍÂÙè·ÕèäË¹..."; break;
			case 3:  .@msg$ = "àÊÕÂ§¢Í§à¾Å§¡ÓÅÑ§¨Ò§ËÒÂä»..."; break;
			default:  .@msg$ = "áÅéÇµÍ¹¹Õé...¨ÐàËÅ×ÍÍÐäÃãËé©Ñ¹ºéÒ§.."; break;
		}
	}
	else if (.@npc_name$ == "#Catherine Cheiron_A1") {
		.@talker_name$ = "#lhz_dun_talk_A5";
		switch (rand(5)) {
			case 0:  .@msg$ = "ÁÑ¹à»ç¹à¤Åç´ÅÑº·Õèá»Å¡ÁÒ¡..."; break;
			case 1:  .@msg$ = "Sob sob...Somebody...Please.."; break;
			case 2:  .@msg$ = "Ë¹ÒÇ¨Ñ§...·Õè¹Õè...à»ç¹â¡´Ñ§ËÃ×Íà»ÅèÒ.."; break;
			case 3:  .@msg$ = "àÊÕÂ§¢Í§©Ñ¹...¨ÐäÁèÍÍ¡ÁÒ..."; break;
			default:  .@msg$ = "à¾×èÍ¹...©Ñ¹¡ÅÑÇ..."; break;
		}
	}
	else if (.@npc_name$ == "#Katrinn Chiron_A2") {
		.@talker_name$ = "#lhz_dun_talk_A6";
		switch (rand(5)) {
			case 0:  .@msg$ = "à«ÂìàÃ¹...à¸ÍÍÂÙèäË¹..."; break;
			case 1:  .@msg$ = "¤ÇÒÁà¨çº»Ç´...¤ÇÒÁÁ×´...©Ñ¹¡ÅÑÇ..."; break;
			case 2:  .@msg$ = "àÇ·Á¹µÃì·ÕèÂÒ¡ÁÒ¡ÊÓËÃÑº©Ñ¹·Õè¨ÐàÃÕÂ¹ÃÙéµÍ¹¹ÕéÁÑ¹äÃé»ÃÐâÂª¹ì..."; break;
			case 3:  .@msg$ = "¾Ç¡·ÕèäÁèãªèÁ¹ØÉÂì..."; break;
			default:  .@msg$ = "à¾×èÍ¹...Á×´à¡Ô¹ä»..."; break;
		}
	}
	else if (.@npc_name$ == "#Celia_Alde_A1") {
		.@talker_name$ = "#lhz_dun_talk_A17";
		switch (rand(5)) {
			case 0:  .@msg$ = "ÍÖ...ºéÒä»áÅéÇ...·Ñé§ËÁ´¹Õé..."; break;
			case 1:  .@msg$ = "©Ñ¹äÁèá¹èã¨ÇèÒ©Ñ¹ÊÒÁÒÃ¶ºÍ¡ä´éÇèÒã¤Ã..."; break;
			case 2:  .@msg$ = "¨ÔµÇÔ­­Ò³·Õè¹èÒÊ§ÊÒÃ·Õè¹Õè...ÍÒ¨à»ç¹..."; break;
			case 3:  .@msg$ = "¹ÕèÁÑ¹äÃéÊÒÃÐ...ÁÑ¹¨Ðà¡Ô´¢Öé¹ä´éÂÑ§ä§..?"; break;
			default:  .@msg$ = "ÂéÓ...¹ÕèÁÑ¹à¡Ô¹¤ÇÒÁÊÒÁÒÃ¶ã¹¡ÒÃÇÔà¤ÃÒÐËì¢Í§©Ñ¹...à»ç¹ä»äÁèä´é..."; break;
		}
	}
	else if (.@npc_name$ == "#Celia_Alde_A2") {
		.@talker_name$ = "#lhz_dun_talk_A18";
		switch (rand(4)) {
			case 0:  .@msg$ = "äÁèÁÕã¤ÃÍÂÙè...¤×ÍÍÐäÃ..."; break;
			case 1:  .@msg$ = "My...survival...and escape...analyzis results..."; break;
			case 2:  .@msg$ = "Where...what...No, no...Never..."; break;
			default:  .@msg$ = "©Ñ¹ÍÂÒ¡ÍÍ¡ä»¨Ò¡·Õè¹ÕèãËéàÃçÇ·ÕèÊØ´..."; break;
		}
	}
	else if (.@npc_name$ == "#Chen_Liu_A1") {
		.@talker_name$ = "#lhz_dun_talk_A19";
		switch (rand(5)) {
			case 0:  .@msg$ = "ËÑÇ¢Í§©Ñ¹ÃÙéÊÖ¡á»Å¡ æ..."; break;
			case 1:  .@msg$ = "Ê¶Ò¹·Õè¹Õé´ÙàËÁ×Í¹¡ÑºËéÍ§ãµé´Ô¹·Õè¶Ù¡·Ôé§ÃéÒ§..."; break;
			case 2:  .@msg$ = "ÁÕá¼Å·ÕèË¹éÒÍ¡...ÁÕÍÐäÃ..."; break;
			case 3:  .@msg$ = "©Ñ¹¡ÓÅÑ§¨ÐàÊÕÂµÑÇ..."; break;
			default:  .@msg$ = "©Ñ¹à»ç¹¾ÃÐ...µÑÇá·¹áËè§¡ÒÃÅ§â·É¨Ò¡ÊÇÃÃ¤ì..."; break;
		}
	}
	else if (.@npc_name$ == "#Chen_Liu_A2") {
		.@talker_name$ = "#lhz_dun_talk_A20";
		switch (rand(4)) {
			case 0:  .@msg$ = "ãºË¹éÒ¢Í§ÈÑµÃÙ...¹Ñè¹¤×ÍãºË¹éÒ¢Í§à¾×èÍ¹ÃèÇÁ§Ò¹..."; break;
			case 1:  .@msg$ = "St Capitolina Abbey...ÂÑ§ÁÕ§Ò¹·ÕèµéÍ§·Ó..."; break;
			case 2:  .@msg$ = "á¼Å¢Í§©Ñ¹¶Ù¡àÂçº...¾Ç¡à¢Ò·ÓÍÐäÃãËé©Ñ¹ä´éºéÒ§.."; break;
			default:  .@msg$ = "¾ÅÑ§ÈÑ¡´ÔìÊÔ·¸Ôì...¾ÅÑ§ã¨..."; break;
		}
	}
	else if (.@npc_name$ == "#Eremes_Guille_A1") {
		.@talker_name$ = "#lhz_dun_talk_A7";
		switch (rand(5)) {
			case 0:  .@msg$ = "ÁØè§à¹é¹ä»·Õè¡ÒÃàÍÒªÕÇÔµÃÍ´..."; break;
			case 1:  .@msg$ = "©Ñ¹áº¡ÂÍ´¡ÔâÂµÔ¹©Ñ¹µéÍ§ÃÍ´!.."; break;
			case 2:  .@msg$ = "ÍÂèÒÂÍÁá¾é...¨ÓÀÒÃ¡Ô¨..."; break;
			case 3:  .@msg$ = "·Ò§ÍÍ¡äÁèã¡ÅéàÅÂ...äÁèàËç¹..."; break;
			default:  .@msg$ = "·Ñé§ËÁ´¹Õé...¶Ù¡ÇÒ§á¼¹ÍÂèÒ§¾Ô¶Õ¾Ô¶Ñ¹á¹è¹Í¹..."; break;
		}
	}
	else if (.@npc_name$ == "#Eremes_Guille_A2") {
		.@talker_name$ = "#lhz_dun_talk_A8";
		switch (rand(5)) {
			case 0:  .@msg$ = "Katrinn äÁèà»ç¹äÃ...©Ñ¹µéÍ§»¡»éÍ§..."; break;
			case 1:  .@msg$ = "©Ñ¹µéÍ§·ÓÀÒÃ¡Ô¨ãËéÊÓàÃç¨...¤ÓÊÑè§¢Í§©Ñ¹..."; break;
			case 2:  .@msg$ = "Assasin Guild ÃÍ©Ñ¹..."; break;
			case 3:  .@msg$ = "©Ñ¹äÁèÍÂÒ¡¨Ðàª×èÍàÅÂÇèÒ©Ñ¹µ¡ËÅØÁ¾ÃÒ§àªè¹¹Õé..."; break;
			default:  .@msg$ = "´Ç§µÒ¢Í§©Ñ¹ÁÑÇ...©Ñ¹¨ÐäÁè¹Ò¹..."; break;
		}
	}
	else if (.@npc_name$ == "#Flamel_Emule_A1") {
		.@talker_name$ = "#lhz_dun_talk_A15";
		switch (rand(5)) {
			case 0:  .@msg$ = "©Ñ¹äÁèà¤ÂÃÙéÊÖ¡ËÁ´Ë¹·Ò§ÁÒ¡èÍ¹..."; break;
			case 1:  .@msg$ = "Celia...©Ñ¹¡ÅÑÇ..."; break;
			case 2:  .@msg$ = "ÃèÒ§¡ÒÂ¢Í§©Ñ¹àµçÁä»´éÇÂÃÍÂá¼Åà»ç¹¨Ò¡¡ÒÃ¼èÒµÑ´..."; break;
			case 3:  .@msg$ = "äÁèÁÕã¤Ã»ÃÒ¡¯µÑÇ...äÁèÁÕã¤Ã...·Õè¹Õè..."; break;
			default:  .@msg$ = "©Ñ¹·¹ä´é..."; break;
		}
	}
	else if (.@npc_name$ == "#Flamel_Emule_A2") {
		.@talker_name$ = "#lhz_dun_talk_A16";
		switch (rand(5)) {
			case 0:  .@msg$ = "¤ÃÍº¤ÃÑÇ¢Í§©Ñ¹...¹Ñ¡¾Ñ¹¸ØÈÒÊµÃì...¨ÐµéÍ§ÍÑºÍÒÂ..."; break;
			case 1:  .@msg$ = "©Ñ¹ÃÙéÊÖ¡àËÁ×Í¹...ÊµÔ¢Í§©Ñ¹...äÁèãªèµÑÇ©Ñ¹ÍÕ¡µèÍä»..."; break;
			case 2:  .@msg$ = "ÊµÔ¢Í§©Ñ¹...¡ÓÅÑ§àÅ×Í¹ÅÒ§..."; break;
			case 3:  .@msg$ = "µÍ¹¹Õé¡ÓÅÑ§àËÅ×ÍÍÂÙè..."; break;
			default:  .@msg$ = "ÃèÒ§¡ÒÂ¢Í§©Ñ¹...ÍÐäÃ...äÁèÁÕ·Ò§..."; break;
		}
	}
	else if (.@npc_name$ == "#Gertie_Wie_A1") {
		.@talker_name$ = "#lhz_dun_talk_A21";
		switch (rand(4)) {
			case 0:  .@msg$ = "àÃÒ¶Ù¡ãªé..."; break;
			case 1:  .@msg$ = "¤Ø³¡ÓÅÑ§·ÓÍÐäÃÍÂÙè..."; break;
			case 2:  .@msg$ = "ÁÑ¹¡ÇéÒ§à¡Ô¹ä»...ÁÍ§äÁèàËç¹·Ò§ÍÍ¡àÅÂ..."; break;
			default:  .@msg$ = "ÎÐ...âª¤ÃéÒÂ..."; break;
		}
	}
	else if (.@npc_name$ == "#Gertie_Wie_A2") {
		.@talker_name$ = "#lhz_dun_talk_A22";
		switch (rand(5)) {
			case 0:  .@msg$ = "©Ñ¹¤ÇÃ¨Ðä´éÃÑºà§Ô¹ÁÒ¡¡ÇèÒ¹Õé¶éÒ©Ñ¹ÃÙéÇèÒÁÑ¹¨Ðà¡Ô´¢Öé¹..."; break;
			case 1:  .@msg$ = "á¡éÁ©Ñ¹áÊº...äÁèÇèÒ¨Ðà¡Ô´ÍÐäÃ¢Öé¹¡ÑºàÃÒ...ÁÑ¹ãªè..."; break;
			case 2:  .@msg$ = "ÍÒÂØ¢Í§©Ñ¹ËÁ´áÅéÇ...à´ç¡ æ...¨ÐàµÔºâµà»ç¹¹Ñ¡Ãº..."; break;
			case 3:  .@msg$ = "©Ñ¹¨Ð´ÙÍÂèÒ§ÃÐÁÑ´ÃÐÇÑ§...©Ñ¹¤ÇÃ¨Ð¨Ó..."; break;
			default:  .@msg$ = "¶éÒàÃÒÃÙéÇèÒÁÑ¹¨Ðà¡Ô´¢Öé¹áÅÐàÃÒ¨Ðä´éÊÔè§¹Õé..."; break;
		}
	}
	else if (.@npc_name$ == "#Harword_AltEisen_A1") {
		.@talker_name$ = "#lhz_dun_talk_A9";
		switch (rand(5)) {
			case 0:  .@msg$ = "µÍ¹¹ÕéÃèÒ§¡ÒÂ¢Í§©Ñ¹à¤Å×èÍ¹äËÇÍÐäÃ...ÁÑ¹à»ç¹¤ÇÒÁ»ÃÐÊ§¤ì¢Í§©Ñ¹¨ÃÔ§æ.."; break;
			case 1:  .@msg$ = "·Õè¹ÕèÍÂÙè·ÕèäË¹?..©Ñ¹äÁèä´éºÍ¡ÍÐäÃàÅÂ..."; break;
			case 2:  .@msg$ = "©Ñ¹¨ÐäÁèä»äË¹...©Ñ¹¨ÐÍÂÙèà¤ÕÂ§¢éÒ§¤Ø³..."; break;
			case 3:  .@msg$ = "©Ñ¹µéÍ§ÁÍ§ËÒà««ÔÅ¹éÍ§ÊÒÇ¢Í§©Ñ¹...äÁèÇèÒ¨Ðà¡Ô´ÍÐäÃ¢Öé¹..."; break;
			default:  .@msg$ = "ÍÑ¹µÃÒÂ...¨Ôµã¨¢Í§©Ñ¹´ÑºÅ§..."; break;
		}
	}
	else if (.@npc_name$ == "#Harword Alt-Eisen_A2") {
		.@talker_name$ = "#lhz_dun_talk_A10";
		switch (rand(3)) {
			case 0:  .@msg$ = "©Ñ¹ÁÍ§äÁèàËç¹Í¹Ò¤µ¢Í§µÑÇàÍ§ÍÕ¡µèÍä»..."; break;
			case 1:  .@msg$ = "µÒ¢Í§©Ñ¹...á¤è»Ô´..."; break;
			default:  .@msg$ = "����ѹ...��鴴������..."; break;
		}
	}
	else if (.@npc_name$ == "#Magaleta_Sorin_A1") {
		.@talker_name$ = "#lhz_dun_talk_A3";
		switch (rand(5)) {
			case 0:  .@msg$ = "Dear Odin...¢ÍãËé Seyren à»ç¹..."; break;
			case 1:  .@msg$ = "·Ñé§ËÁ´¹Õé·ÓãËé©Ñ¹¡ÅÑÇ..."; break;
			case 2:  .@msg$ = "¹Ñè¹äÁèãªè¤ÇÒÁ»ÃÐÊ§¤ì¢Í§©Ñ¹...¹ÕèäÁèãªè©Ñ¹..."; break;
			case 3:  .@msg$ = "¾ÅÑ§ÈÑ¡´ÔìÊÔ·¸ÔìÃÑ¡ÉÒàÅ×Í´´ÓäÁèä´é..."; break;
			default:  .@msg$ = "Dear Odin...May we...May he..."; break;
		}
	}
	else if (.@npc_name$ == "#Magaleta_Sorin_A2") {
		.@talker_name$ = "#lhz_dun_talk_A4";
		switch (rand(4)) {
			case 0:  .@msg$ = "¶Ö§âÍ´Ô¹·ÕèÃÑ¡¢ÍàËÅ×Í¡ÓÅÑ§¢Í§¢éÒäÇé..."; break;
			case 1:  .@msg$ = "ÃèÒ§¡ÒÂ¢Í§©Ñ¹ÊÙ­àÊÕÂ¤ÇÒÁá¢ç§á¡Ãè§..."; break;
			case 2:  .@msg$ = "¾ÅÑ§ÈÑ¡´ÔìÊÔ·¸ÔìÍèÍ¹áÍÅ§àÃ×èÍÂ æ..."; break;
			default:  .@msg$ = "My Seyren...¤Ø³ÍÂÙè·ÕèäË¹..."; break;
		}
	}
	else if (.@npc_name$ == "#Randel_Lawrence_A1") {
		.@talker_name$ = "#lhz_dun_talk_A13";
		switch (rand(4)) {
			case 0:  .@msg$ = "©Ñ¹¶Ù¡Êè§ÁÒ·Õè¹Õèã¹°Ò¹Ð¼ÙéºÑ­ªÒ¡ÒÃ..."; break;
			case 1:  .@msg$ = "µÍ¹¹ÕéÁÑ¹à»ç¹ä»äÁèä´é...¨ÃÔ§æ..."; break;
			case 2:  .@msg$ = "©Ñ¹¨ÐáÊ´§¾ÅÑ§¢Í§¾ÒÅÒ´Ô¹..."; break;
			default:  .@msg$ = "ÅÙ¡àÃ×Í¢Í§©Ñ¹ÍÂÙè·ÕèäË¹..."; break;
		}
	}
	else if (.@npc_name$ == "#Randel_Lawrence_A2") {
		.@talker_name$ = "#lhz_dun_talk_A14";
		switch (rand(5)) {
			case 0:  .@msg$ = "Êè§ÅÙ¡àÃ×Í...¶éÒ¾Ç¡¤Ø³ÃÍ´...¤Ø³µéÍ§ÍÍ¡¨Ò¡ÊÔè§¹Õé...¹Õè¤×Í¤ÓÊÑè§..."; break;
			case 1:  .@msg$ = "¾ÅÑ§¢Í§©Ñ¹ËÒÂä»áÅéÇ..."; break;
			case 2:  .@msg$ = "¹Ñè¹¤×ÍÍÐäÃ..¡ÓÅÑ§à»ÅÕèÂ¹..."; break;
			case 3:  .@msg$ = "©Ñ¹à»ç¹¼ÙéÃÍ´ªÕÇÔµ¤¹ÊØ´·éÒÂ·Õè¹ÕèËÃ×Í.."; break;
			default:  .@msg$ = "©Ñ¹ÃèÇ§ËÅè¹ËÃ×ÍäÁèÁÑ¹Á×´µèÍË¹éÒ©Ñ¹..."; break;
		}
	}
	else if (.@npc_name$ == "#Seyren_Windsor_A1") {
		.@talker_name$ = "#lhz_dun_talk_A1";
		switch (rand(4)) {
			case 0:  .@msg$ = "©Ñ¹µéÍ§ËÒà¾×èÍ¹...©Ñ¹µéÍ§..."; break;
			case 1:  .@msg$ = "â«ÃÔ¹ÍÂÙèäË¹..à¾×èÍ¹©Ñ¹ÊºÒÂ´ÕäËÁ.."; break;
			case 2:  .@msg$ = "ÁÕ¼Ùé·ÃÂÈã¹ËÁÙè¼Ùé¹Ó¢Í§àÃÒ...äÁèÁÕã¤Ã»ÅÍ´ÀÑÂ·Õè¨ÐºÍ¡¡Ñº..."; break;
			default:  .@msg$ = "¾èÍ¢Í§©Ñ¹¤ÇÃä´éÃÑºá¨é§àÃ×èÍ§¹Õé..."; break;
		}
	}
	else if (.@npc_name$ == "#Seyren_Windsor_A2") {
		.@talker_name$ = "#lhz_dun_talk_A2";
		switch (rand(5)) {
			case 0:  .@msg$ = "©Ñ¹ÃÙéÊÖ¡¼Ô´..."; break;
			case 1:  .@msg$ = "©Ñ¹¤×ÍÇÔ¹´ìà«ÍÃìºØµÃáËè§à¡ÕÂÃµÔÂÈ©Ñ¹¨ÐäÁè·ÓãËéª×èÍ¢Í§©Ñ¹à»ç¹ÁÅ·Ô¹..."; break;
			case 2:  .@msg$ = "µéÍ§Ë¹Õ¨Ò¡¾Ç¡à¢Ò...ÊÔè§¹ÕéäÁè¤ÇÃ..."; break;
			case 3:  .@msg$ = "àÃÒäÁèÊÒÁÒÃ¶µÒÂã¹Ê¶Ò¹·Õèàªè¹¹Õé..."; break;
			default:  .@msg$ = "·ÕèÃÑ¡...Margaretha..."; break;
		}
	}
	else if (.@npc_name$ == "#Shecil_Damon_A1") {
		.@talker_name$ = "#lhz_dun_talk_A11";
		switch (rand(5)) {
			case 0:  .@msg$ = "ã¨àÂç¹ æ...äÁèà»ç¹äÃ..."; break;
			case 1:  .@msg$ = "â¶§·Ò§à´Ô¹¹ÕéäÁèãªè·Ò§ÍÍ¡´éÇÂ..."; break;
			case 2:  .@msg$ = "©Ñ¹¨ÐÁÒ...ÃÍ©Ñ¹â«ÃÔ¹..."; break;
			case 3:  .@msg$ = "©Ñ¹¡ÅÑÇ...ÁÒ¡...¡ÅÑÇ..."; break;
			default:  .@msg$ = "©Ñ¹ÂÑ§ÁÕ¸¹ÙáÅÐÅÙ¡ÈÃÍÂÙè..."; break;
		}
	}
	else if (.@npc_name$ == "#Shecil_Damon_A2") {
		.@talker_name$ = "#lhz_dun_talk_A12";
		switch (rand(5)) {
			case 0:  .@msg$ = "©Ñ¹µÒÂáºº¹Õé·Õè¹ÕèäÁèä´é..."; break;
			case 1:  .@msg$ = "â«ÃÔ¹...ä»äË¹..."; break;
			case 2:  .@msg$ = "à¾×èÍ¹...¹Ñè¹¤×ÍÊÔè§·Õè©Ñ¹¤Ô´¶Ö§..."; break;
			case 3:  .@msg$ = "ã¹ªèÍ§¹Ñé¹¤×ÍÍÐäÃ..¨Ðà¡Ô´¢Öé¹·ÕèäË¹..?"; break;
			default:  .@msg$ = "©Ñ¹·Óä´é...ÁÑ¹ÂÑ§äÁè¨º..."; break;
		}
	}
	else if (.@npc_name$ == "#Trentini_A1") {
		.@talker_name$ = "#lhz_dun_talk_A25";
		switch (rand(5)) {
			case 0:  .@msg$ = "©Ñ¹ÃÙéÊÖ¡ä´éÇèÒà¢ÒÍÂÙè·ÕèäË¹..."; break;
			case 1:  .@msg$ = "©Ñ¹¨Ð·ÓÂÑ§ä§´Õ?..»Ç´ËÑÇàËÅ×Íà¡Ô¹..."; break;
			case 2:  .@msg$ = "ÁÑ¹à»ç¹¤ÇÒÁ¼Ô´¢Í§©Ñ¹àÍ§...©Ñ¹¨ÐàÅÔ¡¡Ñº Alphoccio ã¹·ÕèÊØ´..."; break;
			case 3:  .@msg$ = "ÁÑ¹¨ºáÅéÇÁÑ¹¤×Í¡ÒÃ¡´¢Õè...¹Ñè¹¤×Í¼ÅÅÑ¾¸ì..."; break;
			default:  .@msg$ = "©Ñ¹¤Ô´¶Ö§¤Ø³...ÁÒ¡..."; break;
		}
	}
	else if (.@npc_name$ == "#Trentini_A2") {
		.@talker_name$ = "#lhz_dun_talk_A26";
		switch (rand(4)) {
			case 0:  .@msg$ = "ÁÕã¤ÃÍÂÙèÁÑéÂ¤Ð..à¾×èÍ¹¢Í...ÍêÐ..."; break;
			case 1:  .@msg$ = "à¼×Í¡ÍèÒ¹áÅéÇÊÂÍ§..."; break;
			case 2:  .@msg$ = "©Ñ¹ªÍº·Ø¡àÊÕÂ§¢Í§¾Ç¡à¢ÒÁÒ¡..."; break;
			default: .@msg$ = "ÃèÒ§¡ÒÂ¢Í§©Ñ¹¨ÐäÁè¢ÂÑºàÅÂ..."; break;
		}
	}
	npctalk .@msg$, .@talker_name$;
	end;
OnTimer40000:
	stopnpctimer;
	enablenpc strnpcinfo(0);
	end;
}

lhz_dun_n,92,102,0	duplicate(#Alphoccio_Basil_A1)	#Alphoccio_Basil_A2	HIDDEN_WARP_NPC,3,3
lhz_dun_n,150,74,0	duplicate(#Alphoccio_Basil_A1)	#Catherine Cheiron_A1	HIDDEN_WARP_NPC,3,3
lhz_dun_n,174,98,0	duplicate(#Alphoccio_Basil_A1)	#Katrinn Chiron_A2	HIDDEN_WARP_NPC,3,3
lhz_dun_n,25,65,0	duplicate(#Alphoccio_Basil_A1)	#Celia_Alde_A1	HIDDEN_WARP_NPC,3,3
lhz_dun_n,60,102,0	duplicate(#Alphoccio_Basil_A1)	#Celia_Alde_A2	HIDDEN_WARP_NPC,3,3
lhz_dun_n,194,188,0	duplicate(#Alphoccio_Basil_A1)	#Chen_Liu_A1	HIDDEN_WARP_NPC,3,3
lhz_dun_n,255,206,0	duplicate(#Alphoccio_Basil_A1)	#Chen_Liu_A2	HIDDEN_WARP_NPC,3,3
lhz_dun_n,81,184,0	duplicate(#Alphoccio_Basil_A1)	#Eremes_Guille_A1	HIDDEN_WARP_NPC,3,3
lhz_dun_n,113,191,0	duplicate(#Alphoccio_Basil_A1)	#Eremes_Guille_A2	HIDDEN_WARP_NPC,3,3
lhz_dun_n,84,87,0	duplicate(#Alphoccio_Basil_A1)	#Flamel_Emule_A1	HIDDEN_WARP_NPC,3,3
lhz_dun_n,39,55,0	duplicate(#Alphoccio_Basil_A1)	#Flamel_Emule_A2	HIDDEN_WARP_NPC,3,3
lhz_dun_n,232,198,0	duplicate(#Alphoccio_Basil_A1)	#Gertie_Wie_A1	HIDDEN_WARP_NPC,3,3
lhz_dun_n,130,148,0	duplicate(#Alphoccio_Basil_A1)	#Gertie_Wie_A2	HIDDEN_WARP_NPC,3,3
lhz_dun_n,119,195,0	duplicate(#Alphoccio_Basil_A1)	#Harword Alt-Eisen_A1	HIDDEN_WARP_NPC,3,3
lhz_dun_n,158,210,0	duplicate(#Alphoccio_Basil_A1)	#Harword Alt-Eisen_A2	HIDDEN_WARP_NPC,3,3
lhz_dun_n,159,122,0	duplicate(#Alphoccio_Basil_A1)	#Magaleta_Sorin_A1	HIDDEN_WARP_NPC,3,3
lhz_dun_n,133,39,0	duplicate(#Alphoccio_Basil_A1)	#Magaleta_Sorin_A2	HIDDEN_WARP_NPC,3,3
lhz_dun_n,168,193,0	duplicate(#Alphoccio_Basil_A1)	#Randel_Lawrence_A1	HIDDEN_WARP_NPC,3,3
lhz_dun_n,188,188,0	duplicate(#Alphoccio_Basil_A1)	#Randel_Lawrence_A2	HIDDEN_WARP_NPC,3,3
lhz_dun_n,44,155,0	duplicate(#Alphoccio_Basil_A1)	#Seyren Windsor_A1	HIDDEN_WARP_NPC,3,3
lhz_dun_n,54,221,0	duplicate(#Alphoccio_Basil_A1)	#Seyren Windsor_A2	HIDDEN_WARP_NPC,3,3
lhz_dun_n,249,66,0	duplicate(#Alphoccio_Basil_A1)	#Shecil_Damon_A1	HIDDEN_WARP_NPC,3,3
lhz_dun_n,213,97,0	duplicate(#Alphoccio_Basil_A1)	#Shecil_Damon_A2	HIDDEN_WARP_NPC,3,3
lhz_dun_n,191,129,0	duplicate(#Alphoccio_Basil_A1)	#Trentini_A1	HIDDEN_WARP_NPC,3,3
lhz_dun_n,259,132,0	duplicate(#Alphoccio_Basil_A1)	#Trentini_A2	HIDDEN_WARP_NPC,3,3

lhz_dun_n,44,155,6	script	#lhz_dun_talk_A1	CLEAR_NPC,{ end; }
lhz_dun_n,54,221,6	duplicate(#lhz_dun_talk_A1)	#lhz_dun_talk_A2	CLEAR_NPC
lhz_dun_n,159,122,6	duplicate(#lhz_dun_talk_A1)	#lhz_dun_talk_A3	CLEAR_NPC
lhz_dun_n,133,39,6	duplicate(#lhz_dun_talk_A1)	#lhz_dun_talk_A4	CLEAR_NPC
lhz_dun_n,150,74,6	duplicate(#lhz_dun_talk_A1)	#lhz_dun_talk_A5	CLEAR_NPC
lhz_dun_n,174,98,6	duplicate(#lhz_dun_talk_A1)	#lhz_dun_talk_A6	CLEAR_NPC
lhz_dun_n,81,184,6	duplicate(#lhz_dun_talk_A1)	#lhz_dun_talk_A7	CLEAR_NPC
lhz_dun_n,113,191,6	duplicate(#lhz_dun_talk_A1)	#lhz_dun_talk_A8	CLEAR_NPC
lhz_dun_n,119,195,6	duplicate(#lhz_dun_talk_A1)	#lhz_dun_talk_A9	CLEAR_NPC
lhz_dun_n,158,210,6	duplicate(#lhz_dun_talk_A1)	#lhz_dun_talk_A10	CLEAR_NPC
lhz_dun_n,249,66,6	duplicate(#lhz_dun_talk_A1)	#lhz_dun_talk_A11	CLEAR_NPC
lhz_dun_n,213,97,6	duplicate(#lhz_dun_talk_A1)	#lhz_dun_talk_A12	CLEAR_NPC
lhz_dun_n,168,193,6	duplicate(#lhz_dun_talk_A1)	#lhz_dun_talk_A13	CLEAR_NPC
lhz_dun_n,188,188,6	duplicate(#lhz_dun_talk_A1)	#lhz_dun_talk_A14	CLEAR_NPC
lhz_dun_n,84,87,6	duplicate(#lhz_dun_talk_A1)	#lhz_dun_talk_A15	CLEAR_NPC
lhz_dun_n,39,55,6	duplicate(#lhz_dun_talk_A1)	#lhz_dun_talk_A16	CLEAR_NPC
lhz_dun_n,25,65,6	duplicate(#lhz_dun_talk_A1)	#lhz_dun_talk_A17	CLEAR_NPC
lhz_dun_n,60,102,6	duplicate(#lhz_dun_talk_A1)	#lhz_dun_talk_A18	CLEAR_NPC
lhz_dun_n,194,188,6	duplicate(#lhz_dun_talk_A1)	#lhz_dun_talk_A19	CLEAR_NPC
lhz_dun_n,255,206,6	duplicate(#lhz_dun_talk_A1)	#lhz_dun_talk_A20	CLEAR_NPC
lhz_dun_n,232,198,6	duplicate(#lhz_dun_talk_A1)	#lhz_dun_talk_A21	CLEAR_NPC
lhz_dun_n,130,148,6	duplicate(#lhz_dun_talk_A1)	#lhz_dun_talk_A22	CLEAR_NPC
lhz_dun_n,75,121,6	duplicate(#lhz_dun_talk_A1)	#lhz_dun_talk_A23	CLEAR_NPC
lhz_dun_n,92,102,6	duplicate(#lhz_dun_talk_A1)	#lhz_dun_talk_A24	CLEAR_NPC
lhz_dun_n,191,129,6	duplicate(#lhz_dun_talk_A1)	#lhz_dun_talk_A25	CLEAR_NPC
lhz_dun_n,259,132,6	duplicate(#lhz_dun_talk_A1)	#lhz_dun_talk_A26	CLEAR_NPC

// npc location -> quest ID inaccurate
lhz_dun_n,132,61,2	script	A Questionable Device#14684	4_SYSTEM_BOX,5,5,{
	end;
OnTouch:
	.@quest_id = atoi(strnpcinfo(2));
	switch( checkquest(.@quest_id,PLAYTIME) ) {
	case -1:
		break;
	case 0:
	case 1:
		npctalk "...»Ñ¨¨ØºÑ¹...µéÍ§¡ÒÃ...àÇÅÒ..¤ÙÅ..´ÒÇ¹ì..";
		end;
	case 2:
		erasequest .@quest_id;
		break;
	}
	specialeffect EF_MAPPILLAR;
	npctalk "â»Ãâµ¤ÍÅ ©Ø¡à©Ô¹...à»Ô´ãªé..·Õè..RT..017...¤ÙÅ´ÒÇ¹ì...1 ªÑèÇâÁ§......";
	specialeffect2 EF_BABY;
	setquest .@quest_id;// Mysterious Device
	switch( .@quest_id ) {
	case 14684:
		// atk dmg+10%, def+10% on monsters (inaccurates, unknown values)
		// atk+: Swordman, Thief / def+: Acolyte, Merchant
		sc_start2 SC_LHZ_DUN_N1,1800000,10,10,10000,SCSTART_NOTICKDEF;	/// last 30 mins
		break;
	case 14685:
		// atk+: Acolyte, Merchant / def+: Mage, Archer
		sc_start2 SC_LHZ_DUN_N2,1800000,10,10,10000,SCSTART_NOTICKDEF;
		break;
	case 14686:
		// atk+: Mage, Archer / def+: Swordman, Thief
		sc_start2 SC_LHZ_DUN_N3,1800000,10,10,10000,SCSTART_NOTICKDEF;
		break;
	case 14687:
		// atk+: MvPs / def+: MvPs
		sc_start2 SC_LHZ_DUN_N4,1800000,10,10,10000,SCSTART_NOTICKDEF;
		break;
	}
	end;

OnInit:
	.@condition$ = "!isbegin_quest(" + strnpcinfo(2) + ")";
	questinfo( QTYPE_QUEST, QMARK_YELLOW, .@condition$ );
	end;
}

lhz_dun_n,53,127,2	duplicate(A Questionable Device#14684)	A Questionable Device#14685	4_SYSTEM_BOX,5,5
lhz_dun_n,214,127,2	duplicate(A Questionable Device#14684)	A Questionable Device#14686	4_SYSTEM_BOX,5,5
lhz_dun_n,148,148,2	duplicate(A Questionable Device#14684)	A Questionable Device#14687	4_SYSTEM_BOX,5,5

/*
// Unknown effects
lhz_dun_n,130,204,2	script	Dead Man#lhzd01	4_TOWER_06,5,5
lhz_dun_n,78,133,2	script	Dead Man#lhzd02	4_TOWER_06,5,5
lhz_dun_n,47,65,2	script	Dead Man#lhzd03	4_TOWER_06,5,5
lhz_dun_n,141,39,2	script	Dead Man#lhzd04	4_TOWER_06,5,5
lhz_dun_n,123,85,2	script	Dead Man#lhzd05	4_TOWER_06,5,5
lhz_dun_n,212,71,2	script	Dead Man#lhzd06	4_TOWER_06,5,5
lhz_dun_n,213,109,2	script	Dead Man#lhzd07	4_TOWER_06,5,5
lhz_dun_n,145,179,2	script	Dead Man#lhzd08	4_TOWER_06,5,5
lhz_dun_n,233,135,2	script	Dead Man#lhzd09	4_TOWER_06,5,5
lhz_dun_n,241,201,2	script	Dead Man#lhzd10	4_TOWER_06,5,5
lhz_dun_n,150,211,2	script	Dead Man#lhzd11	4_TOWER_03,5,5
lhz_dun_n,69,144,2	script	Dead Man#lhzd12	4_TOWER_03,5,5
lhz_dun_n,113,81,2	script	Dead Man#lhzd13	4_TOWER_03,5,5
lhz_dun_n,144,64,2	script	Dead Man#lhzd14	4_TOWER_03,5,5
lhz_dun_n,157,93,2	script	Dead Man#lhzd15	4_TOWER_03,5,5
lhz_dun_n,231,69,2	script	Dead Man#lhzd16	4_TOWER_03,5,5
lhz_dun_n,179,107,2	script	Dead Man#lhzd17	4_TOWER_03,5,5
lhz_dun_n,172,175,2	script	Dead Man#lhzd18	4_TOWER_03,5,5
lhz_dun_n,228,149,2	script	Dead Man#lhzd19	4_TOWER_03,5,5
lhz_dun_n,248,218,2	script	Dead Man#lhzd20	4_TOWER_03,5,5
lhz_dun_n,139,233,2	script	Dead Man#lhzd21	4_TOWER_08,5,5
lhz_dun_n,69,110,2	script	Dead Man#lhzd22	4_TOWER_08,5,5
lhz_dun_n,100,109,2	script	Dead Man#lhzd23	4_TOWER_08,5,5
lhz_dun_n,137,72,2	script	Dead Man#lhzd24	4_TOWER_08,5,5
lhz_dun_n,169,85,2	script	Dead Man#lhzd25	4_TOWER_08,5,5
lhz_dun_n,245,63,2	script	Dead Man#lhzd26	4_TOWER_08,5,5
lhz_dun_n,182,126,2	script	Dead Man#lhzd27	4_TOWER_08,5,5
lhz_dun_n,182,154,2	script	Dead Man#lhzd28	4_TOWER_08,5,5
lhz_dun_n,246,141,2	script	Dead Man#lhzd29	4_TOWER_08,5,5
lhz_dun_n,236,226,2	script	Dead Man#lhzd30	4_TOWER_08,5,5
lhz_dun_n,38,200,2	script	Dead Man#lhzd31	4_TOWER_11,5,5
lhz_dun_n,95,86,2	script	Dead Man#lhzd32	4_TOWER_11,5,5
lhz_dun_n,98,138,2	script	Dead Man#lhzd33	4_TOWER_11,5,5
lhz_dun_n,145,89,2	script	Dead Man#lhzd34	4_TOWER_11,5,5
lhz_dun_n,186,92,2	script	Dead Man#lhzd35	4_TOWER_11,5,5
lhz_dun_n,181,148,2	script	Dead Man#lhzd36	4_TOWER_11,5,5
lhz_dun_n,181,148,2	script	Dead Man#lhzd37	4_TOWER_11,5,5
lhz_dun_n,203,144,2	script	Dead Man#lhzd38	4_TOWER_11,5,5
lhz_dun_n,240,134,2	script	Dead Man#lhzd39	4_TOWER_11,5,5
lhz_dun_n,141,129,2	script	Dead Man#lhzd40	4_TOWER_11,5,5
lhz_dun_n,81,160,2	script	Dead Man#lhzd41	4_TOWER_13,5,5
lhz_dun_n,41,77,2	script	Dead Man#lhzd42	4_TOWER_13,5,5
lhz_dun_n,99,162,2	script	Dead Man#lhzd43	4_TOWER_13,5,5
lhz_dun_n,136,95,2	script	Dead Man#lhzd44	4_TOWER_13,5,5
lhz_dun_n,184,80,2	script	Dead Man#lhzd45	4_TOWER_13,5,5
lhz_dun_n,202,102,2	script	Dead Man#lhzd46	4_TOWER_13,5,5
lhz_dun_n,157,143,2	script	Dead Man#lhzd47	4_TOWER_13,5,5
lhz_dun_n,202,133,2	script	Dead Man#lhzd48	4_TOWER_13,5,5
lhz_dun_n,220,178,2	script	Dead Man#lhzd49	4_TOWER_13,5,5
lhz_dun_n,131,148,2	script	Dead Man#lhzd50	4_TOWER_13,5,5
*/
